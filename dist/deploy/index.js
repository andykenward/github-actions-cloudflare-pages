import { createRequire as topLevelCreateRequire } from 'module';const require = topLevelCreateRequire(import.meta.url);
var __create=Object.create;var __defProp=Object.defineProperty;var __getOwnPropDesc=Object.getOwnPropertyDescriptor;var __getOwnPropNames=Object.getOwnPropertyNames;var __getProtoOf=Object.getPrototypeOf,__hasOwnProp=Object.prototype.hasOwnProperty;var __name=(target,value)=>__defProp(target,"name",{value,configurable:!0}),__require=(x=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(x,{get:(a,b)=>(typeof require<"u"?require:a)[b]}):x)(function(x){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+x+'" is not supported')});var __commonJS=(cb,mod)=>function(){return mod||(0,cb[__getOwnPropNames(cb)[0]])((mod={exports:{}}).exports,mod),mod.exports};var __copyProps=(to,from,except,desc)=>{if(from&&typeof from=="object"||typeof from=="function")for(let key of __getOwnPropNames(from))!__hasOwnProp.call(to,key)&&key!==except&&__defProp(to,key,{get:()=>from[key],enumerable:!(desc=__getOwnPropDesc(from,key))||desc.enumerable});return to};var __toESM=(mod,isNodeMode,target)=>(target=mod!=null?__create(__getProtoOf(mod)):{},__copyProps(isNodeMode||!mod||!mod.__esModule?__defProp(target,"default",{value:mod,enumerable:!0}):target,mod));var require_utils=__commonJS({"node_modules/.pnpm/@actions+core@1.11.1/node_modules/@actions/core/lib/utils.js"(exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});exports.toCommandProperties=exports.toCommandValue=void 0;function toCommandValue(input){return input==null?"":typeof input=="string"||input instanceof String?input:JSON.stringify(input)}__name(toCommandValue,"toCommandValue");exports.toCommandValue=toCommandValue;function toCommandProperties(annotationProperties){return Object.keys(annotationProperties).length?{title:annotationProperties.title,file:annotationProperties.file,line:annotationProperties.startLine,endLine:annotationProperties.endLine,col:annotationProperties.startColumn,endColumn:annotationProperties.endColumn}:{}}__name(toCommandProperties,"toCommandProperties");exports.toCommandProperties=toCommandProperties}});var require_command=__commonJS({"node_modules/.pnpm/@actions+core@1.11.1/node_modules/@actions/core/lib/command.js"(exports){"use strict";var __createBinding=exports&&exports.__createBinding||(Object.create?function(o,m,k,k2){k2===void 0&&(k2=k);var desc=Object.getOwnPropertyDescriptor(m,k);(!desc||("get"in desc?!m.__esModule:desc.writable||desc.configurable))&&(desc={enumerable:!0,get:__name(function(){return m[k]},"get")}),Object.defineProperty(o,k2,desc)}:function(o,m,k,k2){k2===void 0&&(k2=k),o[k2]=m[k]}),__setModuleDefault=exports&&exports.__setModuleDefault||(Object.create?function(o,v){Object.defineProperty(o,"default",{enumerable:!0,value:v})}:function(o,v){o.default=v}),__importStar=exports&&exports.__importStar||function(mod){if(mod&&mod.__esModule)return mod;var result={};if(mod!=null)for(var k in mod)k!=="default"&&Object.prototype.hasOwnProperty.call(mod,k)&&__createBinding(result,mod,k);return __setModuleDefault(result,mod),result};Object.defineProperty(exports,"__esModule",{value:!0});exports.issue=exports.issueCommand=void 0;var os=__importStar(__require("os")),utils_1=require_utils();function issueCommand(command,properties,message){let cmd=new Command(command,properties,message);process.stdout.write(cmd.toString()+os.EOL)}__name(issueCommand,"issueCommand");exports.issueCommand=issueCommand;function issue(name,message=""){issueCommand(name,{},message)}__name(issue,"issue");exports.issue=issue;var CMD_STRING="::",Command=class{static{__name(this,"Command")}constructor(command,properties,message){command||(command="missing.command"),this.command=command,this.properties=properties,this.message=message}toString(){let cmdStr=CMD_STRING+this.command;if(this.properties&&Object.keys(this.properties).length>0){cmdStr+=" ";let first=!0;for(let key in this.properties)if(this.properties.hasOwnProperty(key)){let val=this.properties[key];val&&(first?first=!1:cmdStr+=",",cmdStr+=`${key}=${escapeProperty(val)}`)}}return cmdStr+=`${CMD_STRING}${escapeData(this.message)}`,cmdStr}};function escapeData(s){return(0,utils_1.toCommandValue)(s).replace(/%/g,"%25").replace(/\r/g,"%0D").replace(/\n/g,"%0A")}__name(escapeData,"escapeData");function escapeProperty(s){return(0,utils_1.toCommandValue)(s).replace(/%/g,"%25").replace(/\r/g,"%0D").replace(/\n/g,"%0A").replace(/:/g,"%3A").replace(/,/g,"%2C")}__name(escapeProperty,"escapeProperty")}});var require_file_command=__commonJS({"node_modules/.pnpm/@actions+core@1.11.1/node_modules/@actions/core/lib/file-command.js"(exports){"use strict";var __createBinding=exports&&exports.__createBinding||(Object.create?function(o,m,k,k2){k2===void 0&&(k2=k);var desc=Object.getOwnPropertyDescriptor(m,k);(!desc||("get"in desc?!m.__esModule:desc.writable||desc.configurable))&&(desc={enumerable:!0,get:__name(function(){return m[k]},"get")}),Object.defineProperty(o,k2,desc)}:function(o,m,k,k2){k2===void 0&&(k2=k),o[k2]=m[k]}),__setModuleDefault=exports&&exports.__setModuleDefault||(Object.create?function(o,v){Object.defineProperty(o,"default",{enumerable:!0,value:v})}:function(o,v){o.default=v}),__importStar=exports&&exports.__importStar||function(mod){if(mod&&mod.__esModule)return mod;var result={};if(mod!=null)for(var k in mod)k!=="default"&&Object.prototype.hasOwnProperty.call(mod,k)&&__createBinding(result,mod,k);return __setModuleDefault(result,mod),result};Object.defineProperty(exports,"__esModule",{value:!0});exports.prepareKeyValueMessage=exports.issueFileCommand=void 0;var crypto=__importStar(__require("crypto")),fs=__importStar(__require("fs")),os=__importStar(__require("os")),utils_1=require_utils();function issueFileCommand(command,message){let filePath=process.env[`GITHUB_${command}`];if(!filePath)throw new Error(`Unable to find environment variable for file command ${command}`);if(!fs.existsSync(filePath))throw new Error(`Missing file at path: ${filePath}`);fs.appendFileSync(filePath,`${(0,utils_1.toCommandValue)(message)}${os.EOL}`,{encoding:"utf8"})}__name(issueFileCommand,"issueFileCommand");exports.issueFileCommand=issueFileCommand;function prepareKeyValueMessage(key,value){let delimiter=`ghadelimiter_${crypto.randomUUID()}`,convertedValue=(0,utils_1.toCommandValue)(value);if(key.includes(delimiter))throw new Error(`Unexpected input: name should not contain the delimiter "${delimiter}"`);if(convertedValue.includes(delimiter))throw new Error(`Unexpected input: value should not contain the delimiter "${delimiter}"`);return`${key}<<${delimiter}${os.EOL}${convertedValue}${os.EOL}${delimiter}`}__name(prepareKeyValueMessage,"prepareKeyValueMessage");exports.prepareKeyValueMessage=prepareKeyValueMessage}});var require_proxy=__commonJS({"node_modules/.pnpm/@actions+http-client@2.2.3/node_modules/@actions/http-client/lib/proxy.js"(exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});exports.checkBypass=exports.getProxyUrl=void 0;function getProxyUrl(reqUrl){let usingSsl=reqUrl.protocol==="https:";if(checkBypass(reqUrl))return;let proxyVar=usingSsl?process.env.https_proxy||process.env.HTTPS_PROXY:process.env.http_proxy||process.env.HTTP_PROXY;if(proxyVar)try{return new DecodedURL(proxyVar)}catch{if(!proxyVar.startsWith("http://")&&!proxyVar.startsWith("https://"))return new DecodedURL(`http://${proxyVar}`)}else return}__name(getProxyUrl,"getProxyUrl");exports.getProxyUrl=getProxyUrl;function checkBypass(reqUrl){if(!reqUrl.hostname)return!1;let reqHost=reqUrl.hostname;if(isLoopbackAddress(reqHost))return!0;let noProxy=process.env.no_proxy||process.env.NO_PROXY||"";if(!noProxy)return!1;let reqPort;reqUrl.port?reqPort=Number(reqUrl.port):reqUrl.protocol==="http:"?reqPort=80:reqUrl.protocol==="https:"&&(reqPort=443);let upperReqHosts=[reqUrl.hostname.toUpperCase()];typeof reqPort=="number"&&upperReqHosts.push(`${upperReqHosts[0]}:${reqPort}`);for(let upperNoProxyItem of noProxy.split(",").map(x=>x.trim().toUpperCase()).filter(x=>x))if(upperNoProxyItem==="*"||upperReqHosts.some(x=>x===upperNoProxyItem||x.endsWith(`.${upperNoProxyItem}`)||upperNoProxyItem.startsWith(".")&&x.endsWith(`${upperNoProxyItem}`)))return!0;return!1}__name(checkBypass,"checkBypass");exports.checkBypass=checkBypass;function isLoopbackAddress(host){let hostLower=host.toLowerCase();return hostLower==="localhost"||hostLower.startsWith("127.")||hostLower.startsWith("[::1]")||hostLower.startsWith("[0:0:0:0:0:0:0:1]")}__name(isLoopbackAddress,"isLoopbackAddress");var DecodedURL=class extends URL{static{__name(this,"DecodedURL")}constructor(url,base){super(url,base),this._decodedUsername=decodeURIComponent(super.username),this._decodedPassword=decodeURIComponent(super.password)}get username(){return this._decodedUsername}get password(){return this._decodedPassword}}}});var require_tunnel=__commonJS({"node_modules/.pnpm/tunnel@0.0.6/node_modules/tunnel/lib/tunnel.js"(exports){"use strict";var net=__require("net"),tls=__require("tls"),http=__require("http"),https=__require("https"),events=__require("events"),assert2=__require("assert"),util=__require("util");exports.httpOverHttp=httpOverHttp;exports.httpsOverHttp=httpsOverHttp;exports.httpOverHttps=httpOverHttps;exports.httpsOverHttps=httpsOverHttps;function httpOverHttp(options){var agent=new TunnelingAgent(options);return agent.request=http.request,agent}__name(httpOverHttp,"httpOverHttp");function httpsOverHttp(options){var agent=new TunnelingAgent(options);return agent.request=http.request,agent.createSocket=createSecureSocket,agent.defaultPort=443,agent}__name(httpsOverHttp,"httpsOverHttp");function httpOverHttps(options){var agent=new TunnelingAgent(options);return agent.request=https.request,agent}__name(httpOverHttps,"httpOverHttps");function httpsOverHttps(options){var agent=new TunnelingAgent(options);return agent.request=https.request,agent.createSocket=createSecureSocket,agent.defaultPort=443,agent}__name(httpsOverHttps,"httpsOverHttps");function TunnelingAgent(options){var self=this;self.options=options||{},self.proxyOptions=self.options.proxy||{},self.maxSockets=self.options.maxSockets||http.Agent.defaultMaxSockets,self.requests=[],self.sockets=[],self.on("free",__name(function(socket,host,port,localAddress){for(var options2=toOptions(host,port,localAddress),i=0,len=self.requests.length;i<len;++i){var pending=self.requests[i];if(pending.host===options2.host&&pending.port===options2.port){self.requests.splice(i,1),pending.request.onSocket(socket);return}}socket.destroy(),self.removeSocket(socket)},"onFree"))}__name(TunnelingAgent,"TunnelingAgent");util.inherits(TunnelingAgent,events.EventEmitter);TunnelingAgent.prototype.addRequest=__name(function(req,host,port,localAddress){var self=this,options=mergeOptions({request:req},self.options,toOptions(host,port,localAddress));if(self.sockets.length>=this.maxSockets){self.requests.push(options);return}self.createSocket(options,function(socket){socket.on("free",onFree),socket.on("close",onCloseOrRemove),socket.on("agentRemove",onCloseOrRemove),req.onSocket(socket);function onFree(){self.emit("free",socket,options)}__name(onFree,"onFree");function onCloseOrRemove(err){self.removeSocket(socket),socket.removeListener("free",onFree),socket.removeListener("close",onCloseOrRemove),socket.removeListener("agentRemove",onCloseOrRemove)}__name(onCloseOrRemove,"onCloseOrRemove")})},"addRequest");TunnelingAgent.prototype.createSocket=__name(function(options,cb){var self=this,placeholder={};self.sockets.push(placeholder);var connectOptions=mergeOptions({},self.proxyOptions,{method:"CONNECT",path:options.host+":"+options.port,agent:!1,headers:{host:options.host+":"+options.port}});options.localAddress&&(connectOptions.localAddress=options.localAddress),connectOptions.proxyAuth&&(connectOptions.headers=connectOptions.headers||{},connectOptions.headers["Proxy-Authorization"]="Basic "+new Buffer(connectOptions.proxyAuth).toString("base64")),debug4("making CONNECT request");var connectReq=self.request(connectOptions);connectReq.useChunkedEncodingByDefault=!1,connectReq.once("response",onResponse),connectReq.once("upgrade",onUpgrade),connectReq.once("connect",onConnect),connectReq.once("error",onError),connectReq.end();function onResponse(res){res.upgrade=!0}__name(onResponse,"onResponse");function onUpgrade(res,socket,head){process.nextTick(function(){onConnect(res,socket,head)})}__name(onUpgrade,"onUpgrade");function onConnect(res,socket,head){if(connectReq.removeAllListeners(),socket.removeAllListeners(),res.statusCode!==200){debug4("tunneling socket could not be established, statusCode=%d",res.statusCode),socket.destroy();var error2=new Error("tunneling socket could not be established, statusCode="+res.statusCode);error2.code="ECONNRESET",options.request.emit("error",error2),self.removeSocket(placeholder);return}if(head.length>0){debug4("got illegal response body from proxy"),socket.destroy();var error2=new Error("got illegal response body from proxy");error2.code="ECONNRESET",options.request.emit("error",error2),self.removeSocket(placeholder);return}return debug4("tunneling connection has established"),self.sockets[self.sockets.indexOf(placeholder)]=socket,cb(socket)}__name(onConnect,"onConnect");function onError(cause){connectReq.removeAllListeners(),debug4(`tunneling socket could not be established, cause=%s
`,cause.message,cause.stack);var error2=new Error("tunneling socket could not be established, cause="+cause.message);error2.code="ECONNRESET",options.request.emit("error",error2),self.removeSocket(placeholder)}__name(onError,"onError")},"createSocket");TunnelingAgent.prototype.removeSocket=__name(function(socket){var pos=this.sockets.indexOf(socket);if(pos!==-1){this.sockets.splice(pos,1);var pending=this.requests.shift();pending&&this.createSocket(pending,function(socket2){pending.request.onSocket(socket2)})}},"removeSocket");function createSecureSocket(options,cb){var self=this;TunnelingAgent.prototype.createSocket.call(self,options,function(socket){var hostHeader=options.request.getHeader("host"),tlsOptions=mergeOptions({},self.options,{socket,servername:hostHeader?hostHeader.replace(/:.*$/,""):options.host}),secureSocket=tls.connect(0,tlsOptions);self.sockets[self.sockets.indexOf(socket)]=secureSocket,cb(secureSocket)})}__name(createSecureSocket,"createSecureSocket");function toOptions(host,port,localAddress){return typeof host=="string"?{host,port,localAddress}:host}__name(toOptions,"toOptions");function mergeOptions(target){for(var i=1,len=arguments.length;i<len;++i){var overrides=arguments[i];if(typeof overrides=="object")for(var keys=Object.keys(overrides),j=0,keyLen=keys.length;j<keyLen;++j){var k=keys[j];overrides[k]!==void 0&&(target[k]=overrides[k])}}return target}__name(mergeOptions,"mergeOptions");var debug4;process.env.NODE_DEBUG&&/\btunnel\b/.test(process.env.NODE_DEBUG)?debug4=__name(function(){var args=Array.prototype.slice.call(arguments);typeof args[0]=="string"?args[0]="TUNNEL: "+args[0]:args.unshift("TUNNEL:"),console.error.apply(console,args)},"debug"):debug4=__name(function(){},"debug");exports.debug=debug4}});var require_tunnel2=__commonJS({"node_modules/.pnpm/tunnel@0.0.6/node_modules/tunnel/index.js"(exports,module){module.exports=require_tunnel()}});var require_lib=__commonJS({"node_modules/.pnpm/@actions+http-client@2.2.3/node_modules/@actions/http-client/lib/index.js"(exports){"use strict";var __createBinding=exports&&exports.__createBinding||(Object.create?function(o,m,k,k2){k2===void 0&&(k2=k);var desc=Object.getOwnPropertyDescriptor(m,k);(!desc||("get"in desc?!m.__esModule:desc.writable||desc.configurable))&&(desc={enumerable:!0,get:__name(function(){return m[k]},"get")}),Object.defineProperty(o,k2,desc)}:function(o,m,k,k2){k2===void 0&&(k2=k),o[k2]=m[k]}),__setModuleDefault=exports&&exports.__setModuleDefault||(Object.create?function(o,v){Object.defineProperty(o,"default",{enumerable:!0,value:v})}:function(o,v){o.default=v}),__importStar=exports&&exports.__importStar||function(mod){if(mod&&mod.__esModule)return mod;var result={};if(mod!=null)for(var k in mod)k!=="default"&&Object.prototype.hasOwnProperty.call(mod,k)&&__createBinding(result,mod,k);return __setModuleDefault(result,mod),result},__awaiter=exports&&exports.__awaiter||function(thisArg,_arguments,P,generator){function adopt(value){return value instanceof P?value:new P(function(resolve){resolve(value)})}return __name(adopt,"adopt"),new(P||(P=Promise))(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}__name(fulfilled,"fulfilled");function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}__name(rejected,"rejected");function step(result){result.done?resolve(result.value):adopt(result.value).then(fulfilled,rejected)}__name(step,"step"),step((generator=generator.apply(thisArg,_arguments||[])).next())})};Object.defineProperty(exports,"__esModule",{value:!0});exports.HttpClient=exports.isHttps=exports.HttpClientResponse=exports.HttpClientError=exports.getProxyUrl=exports.MediaTypes=exports.Headers=exports.HttpCodes=void 0;var http=__importStar(__require("http")),https=__importStar(__require("https")),pm=__importStar(require_proxy()),tunnel=__importStar(require_tunnel2()),undici_1=__require("undici"),HttpCodes;(function(HttpCodes2){HttpCodes2[HttpCodes2.OK=200]="OK",HttpCodes2[HttpCodes2.MultipleChoices=300]="MultipleChoices",HttpCodes2[HttpCodes2.MovedPermanently=301]="MovedPermanently",HttpCodes2[HttpCodes2.ResourceMoved=302]="ResourceMoved",HttpCodes2[HttpCodes2.SeeOther=303]="SeeOther",HttpCodes2[HttpCodes2.NotModified=304]="NotModified",HttpCodes2[HttpCodes2.UseProxy=305]="UseProxy",HttpCodes2[HttpCodes2.SwitchProxy=306]="SwitchProxy",HttpCodes2[HttpCodes2.TemporaryRedirect=307]="TemporaryRedirect",HttpCodes2[HttpCodes2.PermanentRedirect=308]="PermanentRedirect",HttpCodes2[HttpCodes2.BadRequest=400]="BadRequest",HttpCodes2[HttpCodes2.Unauthorized=401]="Unauthorized",HttpCodes2[HttpCodes2.PaymentRequired=402]="PaymentRequired",HttpCodes2[HttpCodes2.Forbidden=403]="Forbidden",HttpCodes2[HttpCodes2.NotFound=404]="NotFound",HttpCodes2[HttpCodes2.MethodNotAllowed=405]="MethodNotAllowed",HttpCodes2[HttpCodes2.NotAcceptable=406]="NotAcceptable",HttpCodes2[HttpCodes2.ProxyAuthenticationRequired=407]="ProxyAuthenticationRequired",HttpCodes2[HttpCodes2.RequestTimeout=408]="RequestTimeout",HttpCodes2[HttpCodes2.Conflict=409]="Conflict",HttpCodes2[HttpCodes2.Gone=410]="Gone",HttpCodes2[HttpCodes2.TooManyRequests=429]="TooManyRequests",HttpCodes2[HttpCodes2.InternalServerError=500]="InternalServerError",HttpCodes2[HttpCodes2.NotImplemented=501]="NotImplemented",HttpCodes2[HttpCodes2.BadGateway=502]="BadGateway",HttpCodes2[HttpCodes2.ServiceUnavailable=503]="ServiceUnavailable",HttpCodes2[HttpCodes2.GatewayTimeout=504]="GatewayTimeout"})(HttpCodes||(exports.HttpCodes=HttpCodes={}));var Headers;(function(Headers2){Headers2.Accept="accept",Headers2.ContentType="content-type"})(Headers||(exports.Headers=Headers={}));var MediaTypes;(function(MediaTypes2){MediaTypes2.ApplicationJson="application/json"})(MediaTypes||(exports.MediaTypes=MediaTypes={}));function getProxyUrl(serverUrl){let proxyUrl=pm.getProxyUrl(new URL(serverUrl));return proxyUrl?proxyUrl.href:""}__name(getProxyUrl,"getProxyUrl");exports.getProxyUrl=getProxyUrl;var HttpRedirectCodes=[HttpCodes.MovedPermanently,HttpCodes.ResourceMoved,HttpCodes.SeeOther,HttpCodes.TemporaryRedirect,HttpCodes.PermanentRedirect],HttpResponseRetryCodes=[HttpCodes.BadGateway,HttpCodes.ServiceUnavailable,HttpCodes.GatewayTimeout],RetryableHttpVerbs=["OPTIONS","GET","DELETE","HEAD"],ExponentialBackoffCeiling=10,ExponentialBackoffTimeSlice=5,HttpClientError=class _HttpClientError extends Error{static{__name(this,"HttpClientError")}constructor(message,statusCode){super(message),this.name="HttpClientError",this.statusCode=statusCode,Object.setPrototypeOf(this,_HttpClientError.prototype)}};exports.HttpClientError=HttpClientError;var HttpClientResponse=class{static{__name(this,"HttpClientResponse")}constructor(message){this.message=message}readBody(){return __awaiter(this,void 0,void 0,function*(){return new Promise(resolve=>__awaiter(this,void 0,void 0,function*(){let output=Buffer.alloc(0);this.message.on("data",chunk=>{output=Buffer.concat([output,chunk])}),this.message.on("end",()=>{resolve(output.toString())})}))})}readBodyBuffer(){return __awaiter(this,void 0,void 0,function*(){return new Promise(resolve=>__awaiter(this,void 0,void 0,function*(){let chunks=[];this.message.on("data",chunk=>{chunks.push(chunk)}),this.message.on("end",()=>{resolve(Buffer.concat(chunks))})}))})}};exports.HttpClientResponse=HttpClientResponse;function isHttps(requestUrl){return new URL(requestUrl).protocol==="https:"}__name(isHttps,"isHttps");exports.isHttps=isHttps;var HttpClient=class{static{__name(this,"HttpClient")}constructor(userAgent2,handlers,requestOptions){this._ignoreSslError=!1,this._allowRedirects=!0,this._allowRedirectDowngrade=!1,this._maxRedirects=50,this._allowRetries=!1,this._maxRetries=1,this._keepAlive=!1,this._disposed=!1,this.userAgent=userAgent2,this.handlers=handlers||[],this.requestOptions=requestOptions,requestOptions&&(requestOptions.ignoreSslError!=null&&(this._ignoreSslError=requestOptions.ignoreSslError),this._socketTimeout=requestOptions.socketTimeout,requestOptions.allowRedirects!=null&&(this._allowRedirects=requestOptions.allowRedirects),requestOptions.allowRedirectDowngrade!=null&&(this._allowRedirectDowngrade=requestOptions.allowRedirectDowngrade),requestOptions.maxRedirects!=null&&(this._maxRedirects=Math.max(requestOptions.maxRedirects,0)),requestOptions.keepAlive!=null&&(this._keepAlive=requestOptions.keepAlive),requestOptions.allowRetries!=null&&(this._allowRetries=requestOptions.allowRetries),requestOptions.maxRetries!=null&&(this._maxRetries=requestOptions.maxRetries))}options(requestUrl,additionalHeaders){return __awaiter(this,void 0,void 0,function*(){return this.request("OPTIONS",requestUrl,null,additionalHeaders||{})})}get(requestUrl,additionalHeaders){return __awaiter(this,void 0,void 0,function*(){return this.request("GET",requestUrl,null,additionalHeaders||{})})}del(requestUrl,additionalHeaders){return __awaiter(this,void 0,void 0,function*(){return this.request("DELETE",requestUrl,null,additionalHeaders||{})})}post(requestUrl,data,additionalHeaders){return __awaiter(this,void 0,void 0,function*(){return this.request("POST",requestUrl,data,additionalHeaders||{})})}patch(requestUrl,data,additionalHeaders){return __awaiter(this,void 0,void 0,function*(){return this.request("PATCH",requestUrl,data,additionalHeaders||{})})}put(requestUrl,data,additionalHeaders){return __awaiter(this,void 0,void 0,function*(){return this.request("PUT",requestUrl,data,additionalHeaders||{})})}head(requestUrl,additionalHeaders){return __awaiter(this,void 0,void 0,function*(){return this.request("HEAD",requestUrl,null,additionalHeaders||{})})}sendStream(verb,requestUrl,stream,additionalHeaders){return __awaiter(this,void 0,void 0,function*(){return this.request(verb,requestUrl,stream,additionalHeaders)})}getJson(requestUrl,additionalHeaders={}){return __awaiter(this,void 0,void 0,function*(){additionalHeaders[Headers.Accept]=this._getExistingOrDefaultHeader(additionalHeaders,Headers.Accept,MediaTypes.ApplicationJson);let res=yield this.get(requestUrl,additionalHeaders);return this._processResponse(res,this.requestOptions)})}postJson(requestUrl,obj,additionalHeaders={}){return __awaiter(this,void 0,void 0,function*(){let data=JSON.stringify(obj,null,2);additionalHeaders[Headers.Accept]=this._getExistingOrDefaultHeader(additionalHeaders,Headers.Accept,MediaTypes.ApplicationJson),additionalHeaders[Headers.ContentType]=this._getExistingOrDefaultHeader(additionalHeaders,Headers.ContentType,MediaTypes.ApplicationJson);let res=yield this.post(requestUrl,data,additionalHeaders);return this._processResponse(res,this.requestOptions)})}putJson(requestUrl,obj,additionalHeaders={}){return __awaiter(this,void 0,void 0,function*(){let data=JSON.stringify(obj,null,2);additionalHeaders[Headers.Accept]=this._getExistingOrDefaultHeader(additionalHeaders,Headers.Accept,MediaTypes.ApplicationJson),additionalHeaders[Headers.ContentType]=this._getExistingOrDefaultHeader(additionalHeaders,Headers.ContentType,MediaTypes.ApplicationJson);let res=yield this.put(requestUrl,data,additionalHeaders);return this._processResponse(res,this.requestOptions)})}patchJson(requestUrl,obj,additionalHeaders={}){return __awaiter(this,void 0,void 0,function*(){let data=JSON.stringify(obj,null,2);additionalHeaders[Headers.Accept]=this._getExistingOrDefaultHeader(additionalHeaders,Headers.Accept,MediaTypes.ApplicationJson),additionalHeaders[Headers.ContentType]=this._getExistingOrDefaultHeader(additionalHeaders,Headers.ContentType,MediaTypes.ApplicationJson);let res=yield this.patch(requestUrl,data,additionalHeaders);return this._processResponse(res,this.requestOptions)})}request(verb,requestUrl,data,headers){return __awaiter(this,void 0,void 0,function*(){if(this._disposed)throw new Error("Client has already been disposed.");let parsedUrl=new URL(requestUrl),info3=this._prepareRequest(verb,parsedUrl,headers),maxTries=this._allowRetries&&RetryableHttpVerbs.includes(verb)?this._maxRetries+1:1,numTries=0,response;do{if(response=yield this.requestRaw(info3,data),response&&response.message&&response.message.statusCode===HttpCodes.Unauthorized){let authenticationHandler;for(let handler of this.handlers)if(handler.canHandleAuthentication(response)){authenticationHandler=handler;break}return authenticationHandler?authenticationHandler.handleAuthentication(this,info3,data):response}let redirectsRemaining=this._maxRedirects;for(;response.message.statusCode&&HttpRedirectCodes.includes(response.message.statusCode)&&this._allowRedirects&&redirectsRemaining>0;){let redirectUrl=response.message.headers.location;if(!redirectUrl)break;let parsedRedirectUrl=new URL(redirectUrl);if(parsedUrl.protocol==="https:"&&parsedUrl.protocol!==parsedRedirectUrl.protocol&&!this._allowRedirectDowngrade)throw new Error("Redirect from HTTPS to HTTP protocol. This downgrade is not allowed for security reasons. If you want to allow this behavior, set the allowRedirectDowngrade option to true.");if(yield response.readBody(),parsedRedirectUrl.hostname!==parsedUrl.hostname)for(let header in headers)header.toLowerCase()==="authorization"&&delete headers[header];info3=this._prepareRequest(verb,parsedRedirectUrl,headers),response=yield this.requestRaw(info3,data),redirectsRemaining--}if(!response.message.statusCode||!HttpResponseRetryCodes.includes(response.message.statusCode))return response;numTries+=1,numTries<maxTries&&(yield response.readBody(),yield this._performExponentialBackoff(numTries))}while(numTries<maxTries);return response})}dispose(){this._agent&&this._agent.destroy(),this._disposed=!0}requestRaw(info3,data){return __awaiter(this,void 0,void 0,function*(){return new Promise((resolve,reject)=>{function callbackForResult(err,res){err?reject(err):res?resolve(res):reject(new Error("Unknown error"))}__name(callbackForResult,"callbackForResult"),this.requestRawWithCallback(info3,data,callbackForResult)})})}requestRawWithCallback(info3,data,onResult){typeof data=="string"&&(info3.options.headers||(info3.options.headers={}),info3.options.headers["Content-Length"]=Buffer.byteLength(data,"utf8"));let callbackCalled=!1;function handleResult(err,res){callbackCalled||(callbackCalled=!0,onResult(err,res))}__name(handleResult,"handleResult");let req=info3.httpModule.request(info3.options,msg=>{let res=new HttpClientResponse(msg);handleResult(void 0,res)}),socket;req.on("socket",sock=>{socket=sock}),req.setTimeout(this._socketTimeout||3*6e4,()=>{socket&&socket.end(),handleResult(new Error(`Request timeout: ${info3.options.path}`))}),req.on("error",function(err){handleResult(err)}),data&&typeof data=="string"&&req.write(data,"utf8"),data&&typeof data!="string"?(data.on("close",function(){req.end()}),data.pipe(req)):req.end()}getAgent(serverUrl){let parsedUrl=new URL(serverUrl);return this._getAgent(parsedUrl)}getAgentDispatcher(serverUrl){let parsedUrl=new URL(serverUrl),proxyUrl=pm.getProxyUrl(parsedUrl);if(proxyUrl&&proxyUrl.hostname)return this._getProxyAgentDispatcher(parsedUrl,proxyUrl)}_prepareRequest(method,requestUrl,headers){let info3={};info3.parsedUrl=requestUrl;let usingSsl=info3.parsedUrl.protocol==="https:";info3.httpModule=usingSsl?https:http;let defaultPort=usingSsl?443:80;if(info3.options={},info3.options.host=info3.parsedUrl.hostname,info3.options.port=info3.parsedUrl.port?parseInt(info3.parsedUrl.port):defaultPort,info3.options.path=(info3.parsedUrl.pathname||"")+(info3.parsedUrl.search||""),info3.options.method=method,info3.options.headers=this._mergeHeaders(headers),this.userAgent!=null&&(info3.options.headers["user-agent"]=this.userAgent),info3.options.agent=this._getAgent(info3.parsedUrl),this.handlers)for(let handler of this.handlers)handler.prepareRequest(info3.options);return info3}_mergeHeaders(headers){return this.requestOptions&&this.requestOptions.headers?Object.assign({},lowercaseKeys2(this.requestOptions.headers),lowercaseKeys2(headers||{})):lowercaseKeys2(headers||{})}_getExistingOrDefaultHeader(additionalHeaders,header,_default){let clientHeader;return this.requestOptions&&this.requestOptions.headers&&(clientHeader=lowercaseKeys2(this.requestOptions.headers)[header]),additionalHeaders[header]||clientHeader||_default}_getAgent(parsedUrl){let agent,proxyUrl=pm.getProxyUrl(parsedUrl),useProxy=proxyUrl&&proxyUrl.hostname;if(this._keepAlive&&useProxy&&(agent=this._proxyAgent),useProxy||(agent=this._agent),agent)return agent;let usingSsl=parsedUrl.protocol==="https:",maxSockets=100;if(this.requestOptions&&(maxSockets=this.requestOptions.maxSockets||http.globalAgent.maxSockets),proxyUrl&&proxyUrl.hostname){let agentOptions={maxSockets,keepAlive:this._keepAlive,proxy:Object.assign(Object.assign({},(proxyUrl.username||proxyUrl.password)&&{proxyAuth:`${proxyUrl.username}:${proxyUrl.password}`}),{host:proxyUrl.hostname,port:proxyUrl.port})},tunnelAgent,overHttps=proxyUrl.protocol==="https:";usingSsl?tunnelAgent=overHttps?tunnel.httpsOverHttps:tunnel.httpsOverHttp:tunnelAgent=overHttps?tunnel.httpOverHttps:tunnel.httpOverHttp,agent=tunnelAgent(agentOptions),this._proxyAgent=agent}if(!agent){let options={keepAlive:this._keepAlive,maxSockets};agent=usingSsl?new https.Agent(options):new http.Agent(options),this._agent=agent}return usingSsl&&this._ignoreSslError&&(agent.options=Object.assign(agent.options||{},{rejectUnauthorized:!1})),agent}_getProxyAgentDispatcher(parsedUrl,proxyUrl){let proxyAgent;if(this._keepAlive&&(proxyAgent=this._proxyAgentDispatcher),proxyAgent)return proxyAgent;let usingSsl=parsedUrl.protocol==="https:";return proxyAgent=new undici_1.ProxyAgent(Object.assign({uri:proxyUrl.href,pipelining:this._keepAlive?1:0},(proxyUrl.username||proxyUrl.password)&&{token:`Basic ${Buffer.from(`${proxyUrl.username}:${proxyUrl.password}`).toString("base64")}`})),this._proxyAgentDispatcher=proxyAgent,usingSsl&&this._ignoreSslError&&(proxyAgent.options=Object.assign(proxyAgent.options.requestTls||{},{rejectUnauthorized:!1})),proxyAgent}_performExponentialBackoff(retryNumber){return __awaiter(this,void 0,void 0,function*(){retryNumber=Math.min(ExponentialBackoffCeiling,retryNumber);let ms=ExponentialBackoffTimeSlice*Math.pow(2,retryNumber);return new Promise(resolve=>setTimeout(()=>resolve(),ms))})}_processResponse(res,options){return __awaiter(this,void 0,void 0,function*(){return new Promise((resolve,reject)=>__awaiter(this,void 0,void 0,function*(){let statusCode=res.message.statusCode||0,response={statusCode,result:null,headers:{}};statusCode===HttpCodes.NotFound&&resolve(response);function dateTimeDeserializer(key,value){if(typeof value=="string"){let a=new Date(value);if(!isNaN(a.valueOf()))return a}return value}__name(dateTimeDeserializer,"dateTimeDeserializer");let obj,contents;try{contents=yield res.readBody(),contents&&contents.length>0&&(options&&options.deserializeDates?obj=JSON.parse(contents,dateTimeDeserializer):obj=JSON.parse(contents),response.result=obj),response.headers=res.message.headers}catch{}if(statusCode>299){let msg;obj&&obj.message?msg=obj.message:contents&&contents.length>0?msg=contents:msg=`Failed request: (${statusCode})`;let err=new HttpClientError(msg,statusCode);err.result=response.result,reject(err)}else resolve(response)}))})}};exports.HttpClient=HttpClient;var lowercaseKeys2=__name(obj=>Object.keys(obj).reduce((c,k)=>(c[k.toLowerCase()]=obj[k],c),{}),"lowercaseKeys")}});var require_auth=__commonJS({"node_modules/.pnpm/@actions+http-client@2.2.3/node_modules/@actions/http-client/lib/auth.js"(exports){"use strict";var __awaiter=exports&&exports.__awaiter||function(thisArg,_arguments,P,generator){function adopt(value){return value instanceof P?value:new P(function(resolve){resolve(value)})}return __name(adopt,"adopt"),new(P||(P=Promise))(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}__name(fulfilled,"fulfilled");function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}__name(rejected,"rejected");function step(result){result.done?resolve(result.value):adopt(result.value).then(fulfilled,rejected)}__name(step,"step"),step((generator=generator.apply(thisArg,_arguments||[])).next())})};Object.defineProperty(exports,"__esModule",{value:!0});exports.PersonalAccessTokenCredentialHandler=exports.BearerCredentialHandler=exports.BasicCredentialHandler=void 0;var BasicCredentialHandler=class{static{__name(this,"BasicCredentialHandler")}constructor(username,password){this.username=username,this.password=password}prepareRequest(options){if(!options.headers)throw Error("The request has no headers");options.headers.Authorization=`Basic ${Buffer.from(`${this.username}:${this.password}`).toString("base64")}`}canHandleAuthentication(){return!1}handleAuthentication(){return __awaiter(this,void 0,void 0,function*(){throw new Error("not implemented")})}};exports.BasicCredentialHandler=BasicCredentialHandler;var BearerCredentialHandler=class{static{__name(this,"BearerCredentialHandler")}constructor(token){this.token=token}prepareRequest(options){if(!options.headers)throw Error("The request has no headers");options.headers.Authorization=`Bearer ${this.token}`}canHandleAuthentication(){return!1}handleAuthentication(){return __awaiter(this,void 0,void 0,function*(){throw new Error("not implemented")})}};exports.BearerCredentialHandler=BearerCredentialHandler;var PersonalAccessTokenCredentialHandler=class{static{__name(this,"PersonalAccessTokenCredentialHandler")}constructor(token){this.token=token}prepareRequest(options){if(!options.headers)throw Error("The request has no headers");options.headers.Authorization=`Basic ${Buffer.from(`PAT:${this.token}`).toString("base64")}`}canHandleAuthentication(){return!1}handleAuthentication(){return __awaiter(this,void 0,void 0,function*(){throw new Error("not implemented")})}};exports.PersonalAccessTokenCredentialHandler=PersonalAccessTokenCredentialHandler}});var require_oidc_utils=__commonJS({"node_modules/.pnpm/@actions+core@1.11.1/node_modules/@actions/core/lib/oidc-utils.js"(exports){"use strict";var __awaiter=exports&&exports.__awaiter||function(thisArg,_arguments,P,generator){function adopt(value){return value instanceof P?value:new P(function(resolve){resolve(value)})}return __name(adopt,"adopt"),new(P||(P=Promise))(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}__name(fulfilled,"fulfilled");function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}__name(rejected,"rejected");function step(result){result.done?resolve(result.value):adopt(result.value).then(fulfilled,rejected)}__name(step,"step"),step((generator=generator.apply(thisArg,_arguments||[])).next())})};Object.defineProperty(exports,"__esModule",{value:!0});exports.OidcClient=void 0;var http_client_1=require_lib(),auth_1=require_auth(),core_1=require_core(),OidcClient=class _OidcClient{static{__name(this,"OidcClient")}static createHttpClient(allowRetry=!0,maxRetry=10){let requestOptions={allowRetries:allowRetry,maxRetries:maxRetry};return new http_client_1.HttpClient("actions/oidc-client",[new auth_1.BearerCredentialHandler(_OidcClient.getRequestToken())],requestOptions)}static getRequestToken(){let token=process.env.ACTIONS_ID_TOKEN_REQUEST_TOKEN;if(!token)throw new Error("Unable to get ACTIONS_ID_TOKEN_REQUEST_TOKEN env variable");return token}static getIDTokenUrl(){let runtimeUrl=process.env.ACTIONS_ID_TOKEN_REQUEST_URL;if(!runtimeUrl)throw new Error("Unable to get ACTIONS_ID_TOKEN_REQUEST_URL env variable");return runtimeUrl}static getCall(id_token_url){var _a;return __awaiter(this,void 0,void 0,function*(){let id_token=(_a=(yield _OidcClient.createHttpClient().getJson(id_token_url).catch(error2=>{throw new Error(`Failed to get ID Token. 
 
        Error Code : ${error2.statusCode}
 
        Error Message: ${error2.message}`)})).result)===null||_a===void 0?void 0:_a.value;if(!id_token)throw new Error("Response json body do not have ID Token field");return id_token})}static getIDToken(audience){return __awaiter(this,void 0,void 0,function*(){try{let id_token_url=_OidcClient.getIDTokenUrl();if(audience){let encodedAudience=encodeURIComponent(audience);id_token_url=`${id_token_url}&audience=${encodedAudience}`}(0,core_1.debug)(`ID token url is ${id_token_url}`);let id_token=yield _OidcClient.getCall(id_token_url);return(0,core_1.setSecret)(id_token),id_token}catch(error2){throw new Error(`Error message: ${error2.message}`)}})}};exports.OidcClient=OidcClient}});var require_summary=__commonJS({"node_modules/.pnpm/@actions+core@1.11.1/node_modules/@actions/core/lib/summary.js"(exports){"use strict";var __awaiter=exports&&exports.__awaiter||function(thisArg,_arguments,P,generator){function adopt(value){return value instanceof P?value:new P(function(resolve){resolve(value)})}return __name(adopt,"adopt"),new(P||(P=Promise))(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}__name(fulfilled,"fulfilled");function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}__name(rejected,"rejected");function step(result){result.done?resolve(result.value):adopt(result.value).then(fulfilled,rejected)}__name(step,"step"),step((generator=generator.apply(thisArg,_arguments||[])).next())})};Object.defineProperty(exports,"__esModule",{value:!0});exports.summary=exports.markdownSummary=exports.SUMMARY_DOCS_URL=exports.SUMMARY_ENV_VAR=void 0;var os_1=__require("os"),fs_1=__require("fs"),{access,appendFile,writeFile}=fs_1.promises;exports.SUMMARY_ENV_VAR="GITHUB_STEP_SUMMARY";exports.SUMMARY_DOCS_URL="https://docs.github.com/actions/using-workflows/workflow-commands-for-github-actions#adding-a-job-summary";var Summary=class{static{__name(this,"Summary")}constructor(){this._buffer=""}filePath(){return __awaiter(this,void 0,void 0,function*(){if(this._filePath)return this._filePath;let pathFromEnv=process.env[exports.SUMMARY_ENV_VAR];if(!pathFromEnv)throw new Error(`Unable to find environment variable for $${exports.SUMMARY_ENV_VAR}. Check if your runtime environment supports job summaries.`);try{yield access(pathFromEnv,fs_1.constants.R_OK|fs_1.constants.W_OK)}catch{throw new Error(`Unable to access summary file: '${pathFromEnv}'. Check if the file has correct read/write permissions.`)}return this._filePath=pathFromEnv,this._filePath})}wrap(tag,content,attrs={}){let htmlAttrs=Object.entries(attrs).map(([key,value])=>` ${key}="${value}"`).join("");return content?`<${tag}${htmlAttrs}>${content}</${tag}>`:`<${tag}${htmlAttrs}>`}write(options){return __awaiter(this,void 0,void 0,function*(){let overwrite=!!options?.overwrite,filePath=yield this.filePath();return yield(overwrite?writeFile:appendFile)(filePath,this._buffer,{encoding:"utf8"}),this.emptyBuffer()})}clear(){return __awaiter(this,void 0,void 0,function*(){return this.emptyBuffer().write({overwrite:!0})})}stringify(){return this._buffer}isEmptyBuffer(){return this._buffer.length===0}emptyBuffer(){return this._buffer="",this}addRaw(text,addEOL=!1){return this._buffer+=text,addEOL?this.addEOL():this}addEOL(){return this.addRaw(os_1.EOL)}addCodeBlock(code,lang){let attrs=Object.assign({},lang&&{lang}),element=this.wrap("pre",this.wrap("code",code),attrs);return this.addRaw(element).addEOL()}addList(items,ordered=!1){let tag=ordered?"ol":"ul",listItems=items.map(item=>this.wrap("li",item)).join(""),element=this.wrap(tag,listItems);return this.addRaw(element).addEOL()}addTable(rows){let tableBody=rows.map(row=>{let cells=row.map(cell=>{if(typeof cell=="string")return this.wrap("td",cell);let{header,data,colspan,rowspan}=cell,tag=header?"th":"td",attrs=Object.assign(Object.assign({},colspan&&{colspan}),rowspan&&{rowspan});return this.wrap(tag,data,attrs)}).join("");return this.wrap("tr",cells)}).join(""),element=this.wrap("table",tableBody);return this.addRaw(element).addEOL()}addDetails(label,content){let element=this.wrap("details",this.wrap("summary",label)+content);return this.addRaw(element).addEOL()}addImage(src,alt,options){let{width,height}=options||{},attrs=Object.assign(Object.assign({},width&&{width}),height&&{height}),element=this.wrap("img",null,Object.assign({src,alt},attrs));return this.addRaw(element).addEOL()}addHeading(text,level){let tag=`h${level}`,allowedTag=["h1","h2","h3","h4","h5","h6"].includes(tag)?tag:"h1",element=this.wrap(allowedTag,text);return this.addRaw(element).addEOL()}addSeparator(){let element=this.wrap("hr",null);return this.addRaw(element).addEOL()}addBreak(){let element=this.wrap("br",null);return this.addRaw(element).addEOL()}addQuote(text,cite){let attrs=Object.assign({},cite&&{cite}),element=this.wrap("blockquote",text,attrs);return this.addRaw(element).addEOL()}addLink(text,href){let element=this.wrap("a",text,{href});return this.addRaw(element).addEOL()}},_summary=new Summary;exports.markdownSummary=_summary;exports.summary=_summary}});var require_path_utils=__commonJS({"node_modules/.pnpm/@actions+core@1.11.1/node_modules/@actions/core/lib/path-utils.js"(exports){"use strict";var __createBinding=exports&&exports.__createBinding||(Object.create?function(o,m,k,k2){k2===void 0&&(k2=k);var desc=Object.getOwnPropertyDescriptor(m,k);(!desc||("get"in desc?!m.__esModule:desc.writable||desc.configurable))&&(desc={enumerable:!0,get:__name(function(){return m[k]},"get")}),Object.defineProperty(o,k2,desc)}:function(o,m,k,k2){k2===void 0&&(k2=k),o[k2]=m[k]}),__setModuleDefault=exports&&exports.__setModuleDefault||(Object.create?function(o,v){Object.defineProperty(o,"default",{enumerable:!0,value:v})}:function(o,v){o.default=v}),__importStar=exports&&exports.__importStar||function(mod){if(mod&&mod.__esModule)return mod;var result={};if(mod!=null)for(var k in mod)k!=="default"&&Object.prototype.hasOwnProperty.call(mod,k)&&__createBinding(result,mod,k);return __setModuleDefault(result,mod),result};Object.defineProperty(exports,"__esModule",{value:!0});exports.toPlatformPath=exports.toWin32Path=exports.toPosixPath=void 0;var path2=__importStar(__require("path"));function toPosixPath(pth){return pth.replace(/[\\]/g,"/")}__name(toPosixPath,"toPosixPath");exports.toPosixPath=toPosixPath;function toWin32Path(pth){return pth.replace(/[/]/g,"\\")}__name(toWin32Path,"toWin32Path");exports.toWin32Path=toWin32Path;function toPlatformPath(pth){return pth.replace(/[/\\]/g,path2.sep)}__name(toPlatformPath,"toPlatformPath");exports.toPlatformPath=toPlatformPath}});var require_io_util=__commonJS({"node_modules/.pnpm/@actions+io@1.1.3/node_modules/@actions/io/lib/io-util.js"(exports){"use strict";var __createBinding=exports&&exports.__createBinding||(Object.create?function(o,m,k,k2){k2===void 0&&(k2=k),Object.defineProperty(o,k2,{enumerable:!0,get:__name(function(){return m[k]},"get")})}:function(o,m,k,k2){k2===void 0&&(k2=k),o[k2]=m[k]}),__setModuleDefault=exports&&exports.__setModuleDefault||(Object.create?function(o,v){Object.defineProperty(o,"default",{enumerable:!0,value:v})}:function(o,v){o.default=v}),__importStar=exports&&exports.__importStar||function(mod){if(mod&&mod.__esModule)return mod;var result={};if(mod!=null)for(var k in mod)k!=="default"&&Object.hasOwnProperty.call(mod,k)&&__createBinding(result,mod,k);return __setModuleDefault(result,mod),result},__awaiter=exports&&exports.__awaiter||function(thisArg,_arguments,P,generator){function adopt(value){return value instanceof P?value:new P(function(resolve){resolve(value)})}return __name(adopt,"adopt"),new(P||(P=Promise))(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}__name(fulfilled,"fulfilled");function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}__name(rejected,"rejected");function step(result){result.done?resolve(result.value):adopt(result.value).then(fulfilled,rejected)}__name(step,"step"),step((generator=generator.apply(thisArg,_arguments||[])).next())})},_a;Object.defineProperty(exports,"__esModule",{value:!0});exports.getCmdPath=exports.tryGetExecutablePath=exports.isRooted=exports.isDirectory=exports.exists=exports.READONLY=exports.UV_FS_O_EXLOCK=exports.IS_WINDOWS=exports.unlink=exports.symlink=exports.stat=exports.rmdir=exports.rm=exports.rename=exports.readlink=exports.readdir=exports.open=exports.mkdir=exports.lstat=exports.copyFile=exports.chmod=void 0;var fs=__importStar(__require("fs")),path2=__importStar(__require("path"));_a=fs.promises,exports.chmod=_a.chmod,exports.copyFile=_a.copyFile,exports.lstat=_a.lstat,exports.mkdir=_a.mkdir,exports.open=_a.open,exports.readdir=_a.readdir,exports.readlink=_a.readlink,exports.rename=_a.rename,exports.rm=_a.rm,exports.rmdir=_a.rmdir,exports.stat=_a.stat,exports.symlink=_a.symlink,exports.unlink=_a.unlink;exports.IS_WINDOWS=process.platform==="win32";exports.UV_FS_O_EXLOCK=268435456;exports.READONLY=fs.constants.O_RDONLY;function exists(fsPath){return __awaiter(this,void 0,void 0,function*(){try{yield exports.stat(fsPath)}catch(err){if(err.code==="ENOENT")return!1;throw err}return!0})}__name(exists,"exists");exports.exists=exists;function isDirectory(fsPath,useStat=!1){return __awaiter(this,void 0,void 0,function*(){return(useStat?yield exports.stat(fsPath):yield exports.lstat(fsPath)).isDirectory()})}__name(isDirectory,"isDirectory");exports.isDirectory=isDirectory;function isRooted(p){if(p=normalizeSeparators(p),!p)throw new Error('isRooted() parameter "p" cannot be empty');return exports.IS_WINDOWS?p.startsWith("\\")||/^[A-Z]:/i.test(p):p.startsWith("/")}__name(isRooted,"isRooted");exports.isRooted=isRooted;function tryGetExecutablePath(filePath,extensions){return __awaiter(this,void 0,void 0,function*(){let stats;try{stats=yield exports.stat(filePath)}catch(err){err.code!=="ENOENT"&&console.log(`Unexpected error attempting to determine if executable file exists '${filePath}': ${err}`)}if(stats&&stats.isFile()){if(exports.IS_WINDOWS){let upperExt=path2.extname(filePath).toUpperCase();if(extensions.some(validExt=>validExt.toUpperCase()===upperExt))return filePath}else if(isUnixExecutable(stats))return filePath}let originalFilePath=filePath;for(let extension of extensions){filePath=originalFilePath+extension,stats=void 0;try{stats=yield exports.stat(filePath)}catch(err){err.code!=="ENOENT"&&console.log(`Unexpected error attempting to determine if executable file exists '${filePath}': ${err}`)}if(stats&&stats.isFile()){if(exports.IS_WINDOWS){try{let directory=path2.dirname(filePath),upperName=path2.basename(filePath).toUpperCase();for(let actualName of yield exports.readdir(directory))if(upperName===actualName.toUpperCase()){filePath=path2.join(directory,actualName);break}}catch(err){console.log(`Unexpected error attempting to determine the actual case of the file '${filePath}': ${err}`)}return filePath}else if(isUnixExecutable(stats))return filePath}}return""})}__name(tryGetExecutablePath,"tryGetExecutablePath");exports.tryGetExecutablePath=tryGetExecutablePath;function normalizeSeparators(p){return p=p||"",exports.IS_WINDOWS?(p=p.replace(/\//g,"\\"),p.replace(/\\\\+/g,"\\")):p.replace(/\/\/+/g,"/")}__name(normalizeSeparators,"normalizeSeparators");function isUnixExecutable(stats){return(stats.mode&1)>0||(stats.mode&8)>0&&stats.gid===process.getgid()||(stats.mode&64)>0&&stats.uid===process.getuid()}__name(isUnixExecutable,"isUnixExecutable");function getCmdPath(){var _a2;return(_a2=process.env.COMSPEC)!==null&&_a2!==void 0?_a2:"cmd.exe"}__name(getCmdPath,"getCmdPath");exports.getCmdPath=getCmdPath}});var require_io=__commonJS({"node_modules/.pnpm/@actions+io@1.1.3/node_modules/@actions/io/lib/io.js"(exports){"use strict";var __createBinding=exports&&exports.__createBinding||(Object.create?function(o,m,k,k2){k2===void 0&&(k2=k),Object.defineProperty(o,k2,{enumerable:!0,get:__name(function(){return m[k]},"get")})}:function(o,m,k,k2){k2===void 0&&(k2=k),o[k2]=m[k]}),__setModuleDefault=exports&&exports.__setModuleDefault||(Object.create?function(o,v){Object.defineProperty(o,"default",{enumerable:!0,value:v})}:function(o,v){o.default=v}),__importStar=exports&&exports.__importStar||function(mod){if(mod&&mod.__esModule)return mod;var result={};if(mod!=null)for(var k in mod)k!=="default"&&Object.hasOwnProperty.call(mod,k)&&__createBinding(result,mod,k);return __setModuleDefault(result,mod),result},__awaiter=exports&&exports.__awaiter||function(thisArg,_arguments,P,generator){function adopt(value){return value instanceof P?value:new P(function(resolve){resolve(value)})}return __name(adopt,"adopt"),new(P||(P=Promise))(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}__name(fulfilled,"fulfilled");function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}__name(rejected,"rejected");function step(result){result.done?resolve(result.value):adopt(result.value).then(fulfilled,rejected)}__name(step,"step"),step((generator=generator.apply(thisArg,_arguments||[])).next())})};Object.defineProperty(exports,"__esModule",{value:!0});exports.findInPath=exports.which=exports.mkdirP=exports.rmRF=exports.mv=exports.cp=void 0;var assert_1=__require("assert"),path2=__importStar(__require("path")),ioUtil=__importStar(require_io_util());function cp(source,dest,options={}){return __awaiter(this,void 0,void 0,function*(){let{force,recursive,copySourceDirectory}=readCopyOptions(options),destStat=(yield ioUtil.exists(dest))?yield ioUtil.stat(dest):null;if(destStat&&destStat.isFile()&&!force)return;let newDest=destStat&&destStat.isDirectory()&&copySourceDirectory?path2.join(dest,path2.basename(source)):dest;if(!(yield ioUtil.exists(source)))throw new Error(`no such file or directory: ${source}`);if((yield ioUtil.stat(source)).isDirectory())if(recursive)yield cpDirRecursive(source,newDest,0,force);else throw new Error(`Failed to copy. ${source} is a directory, but tried to copy without recursive flag.`);else{if(path2.relative(source,newDest)==="")throw new Error(`'${newDest}' and '${source}' are the same file`);yield copyFile(source,newDest,force)}})}__name(cp,"cp");exports.cp=cp;function mv(source,dest,options={}){return __awaiter(this,void 0,void 0,function*(){if(yield ioUtil.exists(dest)){let destExists=!0;if((yield ioUtil.isDirectory(dest))&&(dest=path2.join(dest,path2.basename(source)),destExists=yield ioUtil.exists(dest)),destExists)if(options.force==null||options.force)yield rmRF(dest);else throw new Error("Destination already exists")}yield mkdirP(path2.dirname(dest)),yield ioUtil.rename(source,dest)})}__name(mv,"mv");exports.mv=mv;function rmRF(inputPath){return __awaiter(this,void 0,void 0,function*(){if(ioUtil.IS_WINDOWS&&/[*"<>|]/.test(inputPath))throw new Error('File path must not contain `*`, `"`, `<`, `>` or `|` on Windows');try{yield ioUtil.rm(inputPath,{force:!0,maxRetries:3,recursive:!0,retryDelay:300})}catch(err){throw new Error(`File was unable to be removed ${err}`)}})}__name(rmRF,"rmRF");exports.rmRF=rmRF;function mkdirP(fsPath){return __awaiter(this,void 0,void 0,function*(){assert_1.ok(fsPath,"a path argument must be provided"),yield ioUtil.mkdir(fsPath,{recursive:!0})})}__name(mkdirP,"mkdirP");exports.mkdirP=mkdirP;function which(tool,check){return __awaiter(this,void 0,void 0,function*(){if(!tool)throw new Error("parameter 'tool' is required");if(check){let result=yield which(tool,!1);if(!result)throw ioUtil.IS_WINDOWS?new Error(`Unable to locate executable file: ${tool}. Please verify either the file path exists or the file can be found within a directory specified by the PATH environment variable. Also verify the file has a valid extension for an executable file.`):new Error(`Unable to locate executable file: ${tool}. Please verify either the file path exists or the file can be found within a directory specified by the PATH environment variable. Also check the file mode to verify the file is executable.`);return result}let matches=yield findInPath(tool);return matches&&matches.length>0?matches[0]:""})}__name(which,"which");exports.which=which;function findInPath(tool){return __awaiter(this,void 0,void 0,function*(){if(!tool)throw new Error("parameter 'tool' is required");let extensions=[];if(ioUtil.IS_WINDOWS&&process.env.PATHEXT)for(let extension of process.env.PATHEXT.split(path2.delimiter))extension&&extensions.push(extension);if(ioUtil.isRooted(tool)){let filePath=yield ioUtil.tryGetExecutablePath(tool,extensions);return filePath?[filePath]:[]}if(tool.includes(path2.sep))return[];let directories=[];if(process.env.PATH)for(let p of process.env.PATH.split(path2.delimiter))p&&directories.push(p);let matches=[];for(let directory of directories){let filePath=yield ioUtil.tryGetExecutablePath(path2.join(directory,tool),extensions);filePath&&matches.push(filePath)}return matches})}__name(findInPath,"findInPath");exports.findInPath=findInPath;function readCopyOptions(options){let force=options.force==null?!0:options.force,recursive=!!options.recursive,copySourceDirectory=options.copySourceDirectory==null?!0:!!options.copySourceDirectory;return{force,recursive,copySourceDirectory}}__name(readCopyOptions,"readCopyOptions");function cpDirRecursive(sourceDir,destDir,currentDepth,force){return __awaiter(this,void 0,void 0,function*(){if(currentDepth>=255)return;currentDepth++,yield mkdirP(destDir);let files=yield ioUtil.readdir(sourceDir);for(let fileName of files){let srcFile=`${sourceDir}/${fileName}`,destFile=`${destDir}/${fileName}`;(yield ioUtil.lstat(srcFile)).isDirectory()?yield cpDirRecursive(srcFile,destFile,currentDepth,force):yield copyFile(srcFile,destFile,force)}yield ioUtil.chmod(destDir,(yield ioUtil.stat(sourceDir)).mode)})}__name(cpDirRecursive,"cpDirRecursive");function copyFile(srcFile,destFile,force){return __awaiter(this,void 0,void 0,function*(){if((yield ioUtil.lstat(srcFile)).isSymbolicLink()){try{yield ioUtil.lstat(destFile),yield ioUtil.unlink(destFile)}catch(e){e.code==="EPERM"&&(yield ioUtil.chmod(destFile,"0666"),yield ioUtil.unlink(destFile))}let symlinkFull=yield ioUtil.readlink(srcFile);yield ioUtil.symlink(symlinkFull,destFile,ioUtil.IS_WINDOWS?"junction":null)}else(!(yield ioUtil.exists(destFile))||force)&&(yield ioUtil.copyFile(srcFile,destFile))})}__name(copyFile,"copyFile")}});var require_toolrunner=__commonJS({"node_modules/.pnpm/@actions+exec@1.1.1/node_modules/@actions/exec/lib/toolrunner.js"(exports){"use strict";var __createBinding=exports&&exports.__createBinding||(Object.create?function(o,m,k,k2){k2===void 0&&(k2=k),Object.defineProperty(o,k2,{enumerable:!0,get:__name(function(){return m[k]},"get")})}:function(o,m,k,k2){k2===void 0&&(k2=k),o[k2]=m[k]}),__setModuleDefault=exports&&exports.__setModuleDefault||(Object.create?function(o,v){Object.defineProperty(o,"default",{enumerable:!0,value:v})}:function(o,v){o.default=v}),__importStar=exports&&exports.__importStar||function(mod){if(mod&&mod.__esModule)return mod;var result={};if(mod!=null)for(var k in mod)k!=="default"&&Object.hasOwnProperty.call(mod,k)&&__createBinding(result,mod,k);return __setModuleDefault(result,mod),result},__awaiter=exports&&exports.__awaiter||function(thisArg,_arguments,P,generator){function adopt(value){return value instanceof P?value:new P(function(resolve){resolve(value)})}return __name(adopt,"adopt"),new(P||(P=Promise))(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}__name(fulfilled,"fulfilled");function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}__name(rejected,"rejected");function step(result){result.done?resolve(result.value):adopt(result.value).then(fulfilled,rejected)}__name(step,"step"),step((generator=generator.apply(thisArg,_arguments||[])).next())})};Object.defineProperty(exports,"__esModule",{value:!0});exports.argStringToArray=exports.ToolRunner=void 0;var os=__importStar(__require("os")),events=__importStar(__require("events")),child=__importStar(__require("child_process")),path2=__importStar(__require("path")),io=__importStar(require_io()),ioUtil=__importStar(require_io_util()),timers_1=__require("timers"),IS_WINDOWS=process.platform==="win32",ToolRunner=class extends events.EventEmitter{static{__name(this,"ToolRunner")}constructor(toolPath,args,options){if(super(),!toolPath)throw new Error("Parameter 'toolPath' cannot be null or empty.");this.toolPath=toolPath,this.args=args||[],this.options=options||{}}_debug(message){this.options.listeners&&this.options.listeners.debug&&this.options.listeners.debug(message)}_getCommandString(options,noPrefix){let toolPath=this._getSpawnFileName(),args=this._getSpawnArgs(options),cmd=noPrefix?"":"[command]";if(IS_WINDOWS)if(this._isCmdFile()){cmd+=toolPath;for(let a of args)cmd+=` ${a}`}else if(options.windowsVerbatimArguments){cmd+=`"${toolPath}"`;for(let a of args)cmd+=` ${a}`}else{cmd+=this._windowsQuoteCmdArg(toolPath);for(let a of args)cmd+=` ${this._windowsQuoteCmdArg(a)}`}else{cmd+=toolPath;for(let a of args)cmd+=` ${a}`}return cmd}_processLineBuffer(data,strBuffer,onLine){try{let s=strBuffer+data.toString(),n=s.indexOf(os.EOL);for(;n>-1;){let line=s.substring(0,n);onLine(line),s=s.substring(n+os.EOL.length),n=s.indexOf(os.EOL)}return s}catch(err){return this._debug(`error processing line. Failed with error ${err}`),""}}_getSpawnFileName(){return IS_WINDOWS&&this._isCmdFile()?process.env.COMSPEC||"cmd.exe":this.toolPath}_getSpawnArgs(options){if(IS_WINDOWS&&this._isCmdFile()){let argline=`/D /S /C "${this._windowsQuoteCmdArg(this.toolPath)}`;for(let a of this.args)argline+=" ",argline+=options.windowsVerbatimArguments?a:this._windowsQuoteCmdArg(a);return argline+='"',[argline]}return this.args}_endsWith(str,end){return str.endsWith(end)}_isCmdFile(){let upperToolPath=this.toolPath.toUpperCase();return this._endsWith(upperToolPath,".CMD")||this._endsWith(upperToolPath,".BAT")}_windowsQuoteCmdArg(arg){if(!this._isCmdFile())return this._uvQuoteCmdArg(arg);if(!arg)return'""';let cmdSpecialChars=[" ","	","&","(",")","[","]","{","}","^","=",";","!","'","+",",","`","~","|","<",">",'"'],needsQuotes=!1;for(let char of arg)if(cmdSpecialChars.some(x=>x===char)){needsQuotes=!0;break}if(!needsQuotes)return arg;let reverse='"',quoteHit=!0;for(let i=arg.length;i>0;i--)reverse+=arg[i-1],quoteHit&&arg[i-1]==="\\"?reverse+="\\":arg[i-1]==='"'?(quoteHit=!0,reverse+='"'):quoteHit=!1;return reverse+='"',reverse.split("").reverse().join("")}_uvQuoteCmdArg(arg){if(!arg)return'""';if(!arg.includes(" ")&&!arg.includes("	")&&!arg.includes('"'))return arg;if(!arg.includes('"')&&!arg.includes("\\"))return`"${arg}"`;let reverse='"',quoteHit=!0;for(let i=arg.length;i>0;i--)reverse+=arg[i-1],quoteHit&&arg[i-1]==="\\"?reverse+="\\":arg[i-1]==='"'?(quoteHit=!0,reverse+="\\"):quoteHit=!1;return reverse+='"',reverse.split("").reverse().join("")}_cloneExecOptions(options){options=options||{};let result={cwd:options.cwd||process.cwd(),env:options.env||process.env,silent:options.silent||!1,windowsVerbatimArguments:options.windowsVerbatimArguments||!1,failOnStdErr:options.failOnStdErr||!1,ignoreReturnCode:options.ignoreReturnCode||!1,delay:options.delay||1e4};return result.outStream=options.outStream||process.stdout,result.errStream=options.errStream||process.stderr,result}_getSpawnOptions(options,toolPath){options=options||{};let result={};return result.cwd=options.cwd,result.env=options.env,result.windowsVerbatimArguments=options.windowsVerbatimArguments||this._isCmdFile(),options.windowsVerbatimArguments&&(result.argv0=`"${toolPath}"`),result}exec(){return __awaiter(this,void 0,void 0,function*(){return!ioUtil.isRooted(this.toolPath)&&(this.toolPath.includes("/")||IS_WINDOWS&&this.toolPath.includes("\\"))&&(this.toolPath=path2.resolve(process.cwd(),this.options.cwd||process.cwd(),this.toolPath)),this.toolPath=yield io.which(this.toolPath,!0),new Promise((resolve,reject)=>__awaiter(this,void 0,void 0,function*(){this._debug(`exec tool: ${this.toolPath}`),this._debug("arguments:");for(let arg of this.args)this._debug(`   ${arg}`);let optionsNonNull=this._cloneExecOptions(this.options);!optionsNonNull.silent&&optionsNonNull.outStream&&optionsNonNull.outStream.write(this._getCommandString(optionsNonNull)+os.EOL);let state=new ExecState(optionsNonNull,this.toolPath);if(state.on("debug",message=>{this._debug(message)}),this.options.cwd&&!(yield ioUtil.exists(this.options.cwd)))return reject(new Error(`The cwd: ${this.options.cwd} does not exist!`));let fileName=this._getSpawnFileName(),cp=child.spawn(fileName,this._getSpawnArgs(optionsNonNull),this._getSpawnOptions(this.options,fileName)),stdbuffer="";cp.stdout&&cp.stdout.on("data",data=>{this.options.listeners&&this.options.listeners.stdout&&this.options.listeners.stdout(data),!optionsNonNull.silent&&optionsNonNull.outStream&&optionsNonNull.outStream.write(data),stdbuffer=this._processLineBuffer(data,stdbuffer,line=>{this.options.listeners&&this.options.listeners.stdline&&this.options.listeners.stdline(line)})});let errbuffer="";if(cp.stderr&&cp.stderr.on("data",data=>{state.processStderr=!0,this.options.listeners&&this.options.listeners.stderr&&this.options.listeners.stderr(data),!optionsNonNull.silent&&optionsNonNull.errStream&&optionsNonNull.outStream&&(optionsNonNull.failOnStdErr?optionsNonNull.errStream:optionsNonNull.outStream).write(data),errbuffer=this._processLineBuffer(data,errbuffer,line=>{this.options.listeners&&this.options.listeners.errline&&this.options.listeners.errline(line)})}),cp.on("error",err=>{state.processError=err.message,state.processExited=!0,state.processClosed=!0,state.CheckComplete()}),cp.on("exit",code=>{state.processExitCode=code,state.processExited=!0,this._debug(`Exit code ${code} received from tool '${this.toolPath}'`),state.CheckComplete()}),cp.on("close",code=>{state.processExitCode=code,state.processExited=!0,state.processClosed=!0,this._debug(`STDIO streams have closed for tool '${this.toolPath}'`),state.CheckComplete()}),state.on("done",(error2,exitCode)=>{stdbuffer.length>0&&this.emit("stdline",stdbuffer),errbuffer.length>0&&this.emit("errline",errbuffer),cp.removeAllListeners(),error2?reject(error2):resolve(exitCode)}),this.options.input){if(!cp.stdin)throw new Error("child process missing stdin");cp.stdin.end(this.options.input)}}))})}};exports.ToolRunner=ToolRunner;function argStringToArray(argString){let args=[],inQuotes=!1,escaped=!1,arg="";function append(c){escaped&&c!=='"'&&(arg+="\\"),arg+=c,escaped=!1}__name(append,"append");for(let i=0;i<argString.length;i++){let c=argString.charAt(i);if(c==='"'){escaped?append(c):inQuotes=!inQuotes;continue}if(c==="\\"&&escaped){append(c);continue}if(c==="\\"&&inQuotes){escaped=!0;continue}if(c===" "&&!inQuotes){arg.length>0&&(args.push(arg),arg="");continue}append(c)}return arg.length>0&&args.push(arg.trim()),args}__name(argStringToArray,"argStringToArray");exports.argStringToArray=argStringToArray;var ExecState=class _ExecState extends events.EventEmitter{static{__name(this,"ExecState")}constructor(options,toolPath){if(super(),this.processClosed=!1,this.processError="",this.processExitCode=0,this.processExited=!1,this.processStderr=!1,this.delay=1e4,this.done=!1,this.timeout=null,!toolPath)throw new Error("toolPath must not be empty");this.options=options,this.toolPath=toolPath,options.delay&&(this.delay=options.delay)}CheckComplete(){this.done||(this.processClosed?this._setResult():this.processExited&&(this.timeout=timers_1.setTimeout(_ExecState.HandleTimeout,this.delay,this)))}_debug(message){this.emit("debug",message)}_setResult(){let error2;this.processExited&&(this.processError?error2=new Error(`There was an error when attempting to execute the process '${this.toolPath}'. This may indicate the process failed to start. Error: ${this.processError}`):this.processExitCode!==0&&!this.options.ignoreReturnCode?error2=new Error(`The process '${this.toolPath}' failed with exit code ${this.processExitCode}`):this.processStderr&&this.options.failOnStdErr&&(error2=new Error(`The process '${this.toolPath}' failed because one or more lines were written to the STDERR stream`))),this.timeout&&(clearTimeout(this.timeout),this.timeout=null),this.done=!0,this.emit("done",error2,this.processExitCode)}static HandleTimeout(state){if(!state.done){if(!state.processClosed&&state.processExited){let message=`The STDIO streams did not close within ${state.delay/1e3} seconds of the exit event from process '${state.toolPath}'. This may indicate a child process inherited the STDIO streams and has not yet exited.`;state._debug(message)}state._setResult()}}}}});var require_exec=__commonJS({"node_modules/.pnpm/@actions+exec@1.1.1/node_modules/@actions/exec/lib/exec.js"(exports){"use strict";var __createBinding=exports&&exports.__createBinding||(Object.create?function(o,m,k,k2){k2===void 0&&(k2=k),Object.defineProperty(o,k2,{enumerable:!0,get:__name(function(){return m[k]},"get")})}:function(o,m,k,k2){k2===void 0&&(k2=k),o[k2]=m[k]}),__setModuleDefault=exports&&exports.__setModuleDefault||(Object.create?function(o,v){Object.defineProperty(o,"default",{enumerable:!0,value:v})}:function(o,v){o.default=v}),__importStar=exports&&exports.__importStar||function(mod){if(mod&&mod.__esModule)return mod;var result={};if(mod!=null)for(var k in mod)k!=="default"&&Object.hasOwnProperty.call(mod,k)&&__createBinding(result,mod,k);return __setModuleDefault(result,mod),result},__awaiter=exports&&exports.__awaiter||function(thisArg,_arguments,P,generator){function adopt(value){return value instanceof P?value:new P(function(resolve){resolve(value)})}return __name(adopt,"adopt"),new(P||(P=Promise))(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}__name(fulfilled,"fulfilled");function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}__name(rejected,"rejected");function step(result){result.done?resolve(result.value):adopt(result.value).then(fulfilled,rejected)}__name(step,"step"),step((generator=generator.apply(thisArg,_arguments||[])).next())})};Object.defineProperty(exports,"__esModule",{value:!0});exports.getExecOutput=exports.exec=void 0;var string_decoder_1=__require("string_decoder"),tr=__importStar(require_toolrunner());function exec2(commandLine,args,options){return __awaiter(this,void 0,void 0,function*(){let commandArgs=tr.argStringToArray(commandLine);if(commandArgs.length===0)throw new Error("Parameter 'commandLine' cannot be null or empty.");let toolPath=commandArgs[0];return args=commandArgs.slice(1).concat(args||[]),new tr.ToolRunner(toolPath,args,options).exec()})}__name(exec2,"exec");exports.exec=exec2;function getExecOutput(commandLine,args,options){var _a,_b;return __awaiter(this,void 0,void 0,function*(){let stdout="",stderr="",stdoutDecoder=new string_decoder_1.StringDecoder("utf8"),stderrDecoder=new string_decoder_1.StringDecoder("utf8"),originalStdoutListener=(_a=options?.listeners)===null||_a===void 0?void 0:_a.stdout,originalStdErrListener=(_b=options?.listeners)===null||_b===void 0?void 0:_b.stderr,stdErrListener=__name(data=>{stderr+=stderrDecoder.write(data),originalStdErrListener&&originalStdErrListener(data)},"stdErrListener"),stdOutListener=__name(data=>{stdout+=stdoutDecoder.write(data),originalStdoutListener&&originalStdoutListener(data)},"stdOutListener"),listeners=Object.assign(Object.assign({},options?.listeners),{stdout:stdOutListener,stderr:stdErrListener}),exitCode=yield exec2(commandLine,args,Object.assign(Object.assign({},options),{listeners}));return stdout+=stdoutDecoder.end(),stderr+=stderrDecoder.end(),{exitCode,stdout,stderr}})}__name(getExecOutput,"getExecOutput");exports.getExecOutput=getExecOutput}});var require_platform=__commonJS({"node_modules/.pnpm/@actions+core@1.11.1/node_modules/@actions/core/lib/platform.js"(exports){"use strict";var __createBinding=exports&&exports.__createBinding||(Object.create?function(o,m,k,k2){k2===void 0&&(k2=k);var desc=Object.getOwnPropertyDescriptor(m,k);(!desc||("get"in desc?!m.__esModule:desc.writable||desc.configurable))&&(desc={enumerable:!0,get:__name(function(){return m[k]},"get")}),Object.defineProperty(o,k2,desc)}:function(o,m,k,k2){k2===void 0&&(k2=k),o[k2]=m[k]}),__setModuleDefault=exports&&exports.__setModuleDefault||(Object.create?function(o,v){Object.defineProperty(o,"default",{enumerable:!0,value:v})}:function(o,v){o.default=v}),__importStar=exports&&exports.__importStar||function(mod){if(mod&&mod.__esModule)return mod;var result={};if(mod!=null)for(var k in mod)k!=="default"&&Object.prototype.hasOwnProperty.call(mod,k)&&__createBinding(result,mod,k);return __setModuleDefault(result,mod),result},__awaiter=exports&&exports.__awaiter||function(thisArg,_arguments,P,generator){function adopt(value){return value instanceof P?value:new P(function(resolve){resolve(value)})}return __name(adopt,"adopt"),new(P||(P=Promise))(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}__name(fulfilled,"fulfilled");function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}__name(rejected,"rejected");function step(result){result.done?resolve(result.value):adopt(result.value).then(fulfilled,rejected)}__name(step,"step"),step((generator=generator.apply(thisArg,_arguments||[])).next())})},__importDefault=exports&&exports.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:!0});exports.getDetails=exports.isLinux=exports.isMacOS=exports.isWindows=exports.arch=exports.platform=void 0;var os_1=__importDefault(__require("os")),exec2=__importStar(require_exec()),getWindowsInfo=__name(()=>__awaiter(void 0,void 0,void 0,function*(){let{stdout:version}=yield exec2.getExecOutput('powershell -command "(Get-CimInstance -ClassName Win32_OperatingSystem).Version"',void 0,{silent:!0}),{stdout:name}=yield exec2.getExecOutput('powershell -command "(Get-CimInstance -ClassName Win32_OperatingSystem).Caption"',void 0,{silent:!0});return{name:name.trim(),version:version.trim()}}),"getWindowsInfo"),getMacOsInfo=__name(()=>__awaiter(void 0,void 0,void 0,function*(){var _a,_b,_c,_d;let{stdout}=yield exec2.getExecOutput("sw_vers",void 0,{silent:!0}),version=(_b=(_a=stdout.match(/ProductVersion:\s*(.+)/))===null||_a===void 0?void 0:_a[1])!==null&&_b!==void 0?_b:"";return{name:(_d=(_c=stdout.match(/ProductName:\s*(.+)/))===null||_c===void 0?void 0:_c[1])!==null&&_d!==void 0?_d:"",version}}),"getMacOsInfo"),getLinuxInfo=__name(()=>__awaiter(void 0,void 0,void 0,function*(){let{stdout}=yield exec2.getExecOutput("lsb_release",["-i","-r","-s"],{silent:!0}),[name,version]=stdout.trim().split(`
`);return{name,version}}),"getLinuxInfo");exports.platform=os_1.default.platform();exports.arch=os_1.default.arch();exports.isWindows=exports.platform==="win32";exports.isMacOS=exports.platform==="darwin";exports.isLinux=exports.platform==="linux";function getDetails(){return __awaiter(this,void 0,void 0,function*(){return Object.assign(Object.assign({},yield exports.isWindows?getWindowsInfo():exports.isMacOS?getMacOsInfo():getLinuxInfo()),{platform:exports.platform,arch:exports.arch,isWindows:exports.isWindows,isMacOS:exports.isMacOS,isLinux:exports.isLinux})})}__name(getDetails,"getDetails");exports.getDetails=getDetails}});var require_core=__commonJS({"node_modules/.pnpm/@actions+core@1.11.1/node_modules/@actions/core/lib/core.js"(exports){"use strict";var __createBinding=exports&&exports.__createBinding||(Object.create?function(o,m,k,k2){k2===void 0&&(k2=k);var desc=Object.getOwnPropertyDescriptor(m,k);(!desc||("get"in desc?!m.__esModule:desc.writable||desc.configurable))&&(desc={enumerable:!0,get:__name(function(){return m[k]},"get")}),Object.defineProperty(o,k2,desc)}:function(o,m,k,k2){k2===void 0&&(k2=k),o[k2]=m[k]}),__setModuleDefault=exports&&exports.__setModuleDefault||(Object.create?function(o,v){Object.defineProperty(o,"default",{enumerable:!0,value:v})}:function(o,v){o.default=v}),__importStar=exports&&exports.__importStar||function(mod){if(mod&&mod.__esModule)return mod;var result={};if(mod!=null)for(var k in mod)k!=="default"&&Object.prototype.hasOwnProperty.call(mod,k)&&__createBinding(result,mod,k);return __setModuleDefault(result,mod),result},__awaiter=exports&&exports.__awaiter||function(thisArg,_arguments,P,generator){function adopt(value){return value instanceof P?value:new P(function(resolve){resolve(value)})}return __name(adopt,"adopt"),new(P||(P=Promise))(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}__name(fulfilled,"fulfilled");function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}__name(rejected,"rejected");function step(result){result.done?resolve(result.value):adopt(result.value).then(fulfilled,rejected)}__name(step,"step"),step((generator=generator.apply(thisArg,_arguments||[])).next())})};Object.defineProperty(exports,"__esModule",{value:!0});exports.platform=exports.toPlatformPath=exports.toWin32Path=exports.toPosixPath=exports.markdownSummary=exports.summary=exports.getIDToken=exports.getState=exports.saveState=exports.group=exports.endGroup=exports.startGroup=exports.info=exports.notice=exports.warning=exports.error=exports.debug=exports.isDebug=exports.setFailed=exports.setCommandEcho=exports.setOutput=exports.getBooleanInput=exports.getMultilineInput=exports.getInput=exports.addPath=exports.setSecret=exports.exportVariable=exports.ExitCode=void 0;var command_1=require_command(),file_command_1=require_file_command(),utils_1=require_utils(),os=__importStar(__require("os")),path2=__importStar(__require("path")),oidc_utils_1=require_oidc_utils(),ExitCode;(function(ExitCode2){ExitCode2[ExitCode2.Success=0]="Success",ExitCode2[ExitCode2.Failure=1]="Failure"})(ExitCode||(exports.ExitCode=ExitCode={}));function exportVariable(name,val){let convertedVal=(0,utils_1.toCommandValue)(val);if(process.env[name]=convertedVal,process.env.GITHUB_ENV||"")return(0,file_command_1.issueFileCommand)("ENV",(0,file_command_1.prepareKeyValueMessage)(name,val));(0,command_1.issueCommand)("set-env",{name},convertedVal)}__name(exportVariable,"exportVariable");exports.exportVariable=exportVariable;function setSecret(secret){(0,command_1.issueCommand)("add-mask",{},secret)}__name(setSecret,"setSecret");exports.setSecret=setSecret;function addPath(inputPath){process.env.GITHUB_PATH||""?(0,file_command_1.issueFileCommand)("PATH",inputPath):(0,command_1.issueCommand)("add-path",{},inputPath),process.env.PATH=`${inputPath}${path2.delimiter}${process.env.PATH}`}__name(addPath,"addPath");exports.addPath=addPath;function getInput3(name,options){let val=process.env[`INPUT_${name.replace(/ /g,"_").toUpperCase()}`]||"";if(options&&options.required&&!val)throw new Error(`Input required and not supplied: ${name}`);return options&&options.trimWhitespace===!1?val:val.trim()}__name(getInput3,"getInput");exports.getInput=getInput3;function getMultilineInput(name,options){let inputs=getInput3(name,options).split(`
`).filter(x=>x!=="");return options&&options.trimWhitespace===!1?inputs:inputs.map(input=>input.trim())}__name(getMultilineInput,"getMultilineInput");exports.getMultilineInput=getMultilineInput;function getBooleanInput(name,options){let trueValue=["true","True","TRUE"],falseValue=["false","False","FALSE"],val=getInput3(name,options);if(trueValue.includes(val))return!0;if(falseValue.includes(val))return!1;throw new TypeError(`Input does not meet YAML 1.2 "Core Schema" specification: ${name}
Support boolean input list: \`true | True | TRUE | false | False | FALSE\``)}__name(getBooleanInput,"getBooleanInput");exports.getBooleanInput=getBooleanInput;function setOutput2(name,value){if(process.env.GITHUB_OUTPUT||"")return(0,file_command_1.issueFileCommand)("OUTPUT",(0,file_command_1.prepareKeyValueMessage)(name,value));process.stdout.write(os.EOL),(0,command_1.issueCommand)("set-output",{name},(0,utils_1.toCommandValue)(value))}__name(setOutput2,"setOutput");exports.setOutput=setOutput2;function setCommandEcho(enabled){(0,command_1.issue)("echo",enabled?"on":"off")}__name(setCommandEcho,"setCommandEcho");exports.setCommandEcho=setCommandEcho;function setFailed4(message){process.exitCode=ExitCode.Failure,error2(message)}__name(setFailed4,"setFailed");exports.setFailed=setFailed4;function isDebug3(){return process.env.RUNNER_DEBUG==="1"}__name(isDebug3,"isDebug");exports.isDebug=isDebug3;function debug4(message){(0,command_1.issueCommand)("debug",{},message)}__name(debug4,"debug");exports.debug=debug4;function error2(message,properties={}){(0,command_1.issueCommand)("error",(0,utils_1.toCommandProperties)(properties),message instanceof Error?message.toString():message)}__name(error2,"error");exports.error=error2;function warning(message,properties={}){(0,command_1.issueCommand)("warning",(0,utils_1.toCommandProperties)(properties),message instanceof Error?message.toString():message)}__name(warning,"warning");exports.warning=warning;function notice2(message,properties={}){(0,command_1.issueCommand)("notice",(0,utils_1.toCommandProperties)(properties),message instanceof Error?message.toString():message)}__name(notice2,"notice");exports.notice=notice2;function info3(message){process.stdout.write(message+os.EOL)}__name(info3,"info");exports.info=info3;function startGroup(name){(0,command_1.issue)("group",name)}__name(startGroup,"startGroup");exports.startGroup=startGroup;function endGroup(){(0,command_1.issue)("endgroup")}__name(endGroup,"endGroup");exports.endGroup=endGroup;function group(name,fn){return __awaiter(this,void 0,void 0,function*(){startGroup(name);let result;try{result=yield fn()}finally{endGroup()}return result})}__name(group,"group");exports.group=group;function saveState(name,value){if(process.env.GITHUB_STATE||"")return(0,file_command_1.issueFileCommand)("STATE",(0,file_command_1.prepareKeyValueMessage)(name,value));(0,command_1.issueCommand)("save-state",{name},(0,utils_1.toCommandValue)(value))}__name(saveState,"saveState");exports.saveState=saveState;function getState(name){return process.env[`STATE_${name}`]||""}__name(getState,"getState");exports.getState=getState;function getIDToken(aud){return __awaiter(this,void 0,void 0,function*(){return yield oidc_utils_1.OidcClient.getIDToken(aud)})}__name(getIDToken,"getIDToken");exports.getIDToken=getIDToken;var summary_1=require_summary();Object.defineProperty(exports,"summary",{enumerable:!0,get:__name(function(){return summary_1.summary},"get")});var summary_2=require_summary();Object.defineProperty(exports,"markdownSummary",{enumerable:!0,get:__name(function(){return summary_2.markdownSummary},"get")});var path_utils_1=require_path_utils();Object.defineProperty(exports,"toPosixPath",{enumerable:!0,get:__name(function(){return path_utils_1.toPosixPath},"get")});Object.defineProperty(exports,"toWin32Path",{enumerable:!0,get:__name(function(){return path_utils_1.toWin32Path},"get")});Object.defineProperty(exports,"toPlatformPath",{enumerable:!0,get:__name(function(){return path_utils_1.toPlatformPath},"get")});exports.platform=__importStar(require_platform())}});var import_core13=__toESM(require_core(),1);var import_core12=__toESM(require_core(),1);var import_core7=__toESM(require_core(),1);import{strict}from"node:assert";var import_core3=__toESM(require_core(),1);var import_core=__toESM(require_core(),1);import{exec}from"node:child_process";import{existsSync}from"node:fs";import path from"node:path";import{promisify}from"node:util";var raise=__name(message=>{throw new Error(message)},"raise"),raiseFail=__name(message=>{throw(0,import_core.setFailed)(message),new Error(message)},"raiseFail"),execAsync=promisify(exec),checkWorkingDirectory=__name((directory=".")=>{let p=path.normalize(directory);if(existsSync(p))return p;throw new Error(`Directory not found: ${directory}`)},"checkWorkingDirectory");var import_core2=__toESM(require_core(),1);import{strict as assert}from"node:assert";import{existsSync as existsSync2,readFileSync}from"node:fs";import{EOL}from"node:os";var EVENT_NAMES=["branch_protection_configuration","branch_protection_rule","check_run","check_suite","code_scanning_alert","commit_comment","create","custom_property","custom_property_values","delete","dependabot_alert","deploy_key","deployment","deployment_protection_rule","deployment_review","deployment_status","discussion","discussion_comment","fork","github_app_authorization","gollum","installation","installation_repositories","installation_target","issue_comment","issues","label","marketplace_purchase","member","membership","merge_group","meta","milestone","org_block","organization","package","page_build","ping","project","project_card","project_column","projects_v2_item","public","pull_request","pull_request_review","pull_request_review_comment","pull_request_review_thread","push","registry_package","release","repository","repository_dispatch","repository_import","repository_vulnerability_alert","secret_scanning_alert","secret_scanning_alert_location","security_advisory","sponsorship","star","status","team","team_add","watch","workflow_dispatch","workflow_job","workflow_run"];var getPayload=__name(()=>{if(process.env.GITHUB_EVENT_PATH){if(existsSync2(process.env.GITHUB_EVENT_PATH))return JSON.parse(readFileSync(process.env.GITHUB_EVENT_PATH,{encoding:"utf8"}));{let path2=process.env.GITHUB_EVENT_PATH;process.stdout.write(`GITHUB_EVENT_PATH ${path2} does not exist${EOL}`)}}},"getPayload"),getWorkflowEvent=__name(()=>{let eventName=process.env.GITHUB_EVENT_NAME;assert(EVENT_NAMES.includes(eventName),`eventName ${eventName} is not supported`);let payload=getPayload();return(0,import_core2.isDebug)()&&((0,import_core2.debug)(`eventName: ${eventName}`),(0,import_core2.debug)(`payload: ${JSON.stringify(payload)}`)),{eventName,payload}},"getWorkflowEvent");var getGitHubContext=__name(()=>{let event=getWorkflowEvent(),repo=(()=>{let[owner,repo2]=process.env.GITHUB_REPOSITORY?process.env.GITHUB_REPOSITORY.split("/"):raise("context.repo: requires a GITHUB_REPOSITORY environment variable like 'owner/repo'"),node_id="repository"in event.payload?event.payload.repository?.node_id||raise("context.repo: no repo node_id in payload"):raise("context.repo: no repo node_id in payload");return{owner,repo:repo2,node_id}})(),branch=process.env.GITHUB_HEAD_REF||process.env.GITHUB_REF_NAME,sha=process.env.GITHUB_SHA,graphqlEndpoint=process.env.GITHUB_GRAPHQL_URL,ref=(()=>{let ref2=process.env.GITHUB_HEAD_REF;return!ref2&&("ref"in event.payload?ref2=event.payload.ref:event.eventName==="pull_request"&&(ref2=event.payload.pull_request.head.ref),!ref2)?raise("context: no ref"):ref2})(),context={event,repo,branch,sha,graphqlEndpoint,ref};if((0,import_core3.isDebug)()){let debugContext={...context,event:"will debug itself as output is large"};(0,import_core3.debug)(`context: ${JSON.stringify(debugContext)}`)}return context},"getGitHubContext"),_context,useContext=__name(()=>_context??(_context=getGitHubContext()),"useContext"),useContextEvent=__name(()=>useContext().event,"useContextEvent");var import_core4=__toESM(require_core(),1);var INPUT_KEY_CLOUDFLARE_ACCOUNT_ID="cloudflare-account-id",INPUT_KEY_CLOUDFLARE_API_TOKEN="cloudflare-api-token",INPUT_KEY_CLOUDFLARE_PROJECT_NAME="cloudflare-project-name",INPUT_KEY_DIRECTORY="directory",INPUT_KEY_GITHUB_ENVIRONMENT="github-environment",INPUT_KEY_GITHUB_TOKEN="github-token",INPUT_KEY_WORKING_DIRECTORY="working-directory";var INPUT_KEY_WRANGLER_VERSION="wrangler-version";var getInputs=__name(()=>({cloudflareApiToken:(0,import_core4.getInput)(INPUT_KEY_CLOUDFLARE_API_TOKEN,{required:!0}),gitHubApiToken:(0,import_core4.getInput)(INPUT_KEY_GITHUB_TOKEN,{required:!0}),gitHubEnvironment:(0,import_core4.getInput)(INPUT_KEY_GITHUB_ENVIRONMENT,{required:!1})||void 0,wranglerVersion:(0,import_core4.getInput)(INPUT_KEY_WRANGLER_VERSION)||"^3.73.0"}),"getInputs"),_inputs,useCommonInputs=__name(()=>_inputs??(_inputs=getInputs()),"useCommonInputs");var API_ENDPOINT="https://api.cloudflare.com",getCloudflareApiEndpoint=__name(({path:path2,accountId,projectName})=>{let input=[`/client/v4/accounts/${accountId}/pages/projects/${projectName}`,path2].filter(Boolean).join("/");return new URL(input,API_ENDPOINT).toString()},"getCloudflareApiEndpoint"),getCloudflareLogEndpoint=__name(({id,accountId,projectName})=>new URL(`${accountId}/pages/view/${projectName}/${id}`,"https://dash.cloudflare.com").toString(),"getCloudflareLogEndpoint");var import_core5=__toESM(require_core(),1);var ParseError=class extends Error{static{__name(this,"ParseError")}text;notes;location;kind;code;constructor({text,notes,location,kind}){super(text),this.name=this.constructor.name,this.text=text,this.notes=notes??[],this.location=location,this.kind=kind??"error"}};var throwFetchError=__name((resource,response)=>{let error2=new ParseError({text:`A request to the Cloudflare API (${resource}) failed.`,notes:response.errors.map(err=>({text:renderError(err)}))}),code=response.errors[0]?.code;throw code&&(error2.code=code),error2.notes?.length>0&&error2.notes.map(note=>{(0,import_core5.error)(`Cloudflare API: ${note.text}`)}),error2},"throwFetchError"),renderError=__name((err,level=0)=>{let chainedMessages=err.error_chain?.map(chainedError=>`
${"  ".repeat(level)}- ${renderError(chainedError,level+1)}`).join(`
`)??"";return(err.code?`${err.message} [code: ${err.code}]`:err.message)+chainedMessages},"renderError");var fetchResult=__name(async(resource,init={},queryParams,abortSignal)=>{let method=init.method??"GET",{cloudflareApiToken}=useCommonInputs(),initFetch={headers:{"Content-Type":"application/json;charset=UTF-8",Authorization:`Bearer ${cloudflareApiToken}`}},response=await fetch(resource,{method,...initFetch,signal:abortSignal}).then(response2=>response2.json());if(response.success){if(response.result===null||response.result===void 0)throw new Error("Cloudflare API: response missing 'result'");return response.result}return throwFetchError(resource,response)},"fetchResult");var getCloudflareDeploymentAlias=__name(deployment=>deployment.aliases&&deployment.aliases.length>0?deployment.aliases[0]:deployment.url,"getCloudflareDeploymentAlias"),getCloudflareLatestDeployment=__name(async({accountId,projectName})=>{let{sha:commitHash}=useContext(),deployment=(await fetchResult(getCloudflareApiEndpoint({path:"deployments",accountId,projectName})))?.find(deployment2=>deployment2.deployment_trigger.metadata.commit_hash===commitHash);if(deployment===void 0)throw new Error(`Cloudflare: could not find deployment with commitHash: ${commitHash}`);return deployment},"getCloudflareLatestDeployment");var import_core6=__toESM(require_core(),1);var ERROR_KEY="Status Of Deployment:",statusCloudflareDeployment=__name(async apiEndpoint=>{let deploymentStatus="unknown",deployment;do try{deployment=await getCloudflareLatestDeployment(apiEndpoint);let deployStage=deployment.stages.find(stage=>stage.name==="deploy");switch((0,import_core6.debug)(JSON.stringify(deployStage)),deployStage?.status){case"active":case"success":case"failure":case"skipped":case"canceled":{deploymentStatus=deployStage.status;break}default:await new Promise(resolve=>setTimeout(resolve,1e3))}}catch(error2){throw error2 instanceof Error?error2:error2&&typeof error2=="object"&&"stderr"in error2&&typeof error2.stderr=="string"?new Error(error2.stderr):new Error(`${ERROR_KEY} unknown error`)}while(deploymentStatus==="unknown");return{deployment,status:deploymentStatus}},"statusCloudflareDeployment");var CLOUDFLARE_API_TOKEN="CLOUDFLARE_API_TOKEN",CLOUDFLARE_ACCOUNT_ID="CLOUDFLARE_ACCOUNT_ID",ERROR_KEY2="Create Deployment:",createCloudflareDeployment=__name(async({accountId,projectName,directory,workingDirectory=""})=>{let{cloudflareApiToken,wranglerVersion}=useCommonInputs();process.env[CLOUDFLARE_API_TOKEN]=cloudflareApiToken,process.env[CLOUDFLARE_ACCOUNT_ID]=accountId;let{repo,branch,sha:commitHash}=useContext();if(branch===void 0)throw new Error(`${ERROR_KEY2} branch is undefined`);try{let WRANGLER_VERSION=wranglerVersion;strict(WRANGLER_VERSION,"wrangler version should exist");let{stdout}=await execAsync(`npx wrangler@${WRANGLER_VERSION} pages deploy ${directory} --project-name=${projectName} --branch=${branch} --commit-dirty=true --commit-hash=${commitHash}`,{env:process.env,cwd:workingDirectory});(0,import_core7.info)(stdout);let{deployment,status}=await statusCloudflareDeployment({accountId,projectName});(0,import_core7.setOutput)("id",deployment.id),(0,import_core7.setOutput)("url",deployment.url),(0,import_core7.setOutput)("environment",deployment.environment);let alias=getCloudflareDeploymentAlias(deployment);return(0,import_core7.setOutput)("alias",alias),(0,import_core7.setOutput)("wrangler",stdout),await import_core7.summary.addHeading("Cloudflare Pages Deployment").addBreak().addTable([[{data:"Name",header:!0},{data:"Result",header:!0}],["Environment:",deployment.environment],["Branch:",`<a href='https://github.com/${repo.owner}/${repo.repo}/tree/${deployment.deployment_trigger.metadata.branch}'><code>${deployment.deployment_trigger.metadata.branch}</code></a>`],["Commit Hash:",`<a href='https://github.com/${repo.owner}/${repo.repo}/commit/${deployment.deployment_trigger.metadata.commit_hash}'><code>${deployment.deployment_trigger.metadata.commit_hash}</code></a>`],["Commit Message:",deployment.deployment_trigger.metadata.commit_message],["Status:",`<strong>${status.toUpperCase()||"UNKNOWN"}</strong>`],["Preview URL:",`<a href='${deployment.url}'>${deployment.url}</a>`],["Branch Preview URL:",`<a href='${alias}'>${alias}</a>`],["Wrangler Output:",`${stdout}`]]).write(),{deployment,wranglerOutput:stdout}}catch(error2){throw error2 instanceof Error?error2:error2&&typeof error2=="object"&&"stderr"in error2&&typeof error2.stderr=="string"?new Error(error2.stderr):new Error(`${ERROR_KEY2} unknown error`)}},"createCloudflareDeployment");var import_core9=__toESM(require_core(),1);var TypedDocumentString=class extends String{constructor(value,__meta__){super(value);this.value=value;this.__meta__=__meta__}static{__name(this,"TypedDocumentString")}__apiType;toString(){return this.value}},DeploymentFragmentFragmentDoc=new TypedDocumentString(`
    fragment DeploymentFragment on Deployment {
  id
  environment
  state
}
    `,{fragmentName:"DeploymentFragment"}),EnvironmentFragmentFragmentDoc=new TypedDocumentString(`
    fragment EnvironmentFragment on Environment {
  name
  id
}
    `,{fragmentName:"EnvironmentFragment"}),FilesDocument=new TypedDocumentString(`
    query Files($owner: String!, $repo: String!, $path: String!) {
  repository(owner: $owner, name: $repo) {
    object(expression: $path) {
      __typename
      ... on Tree {
        entries {
          name
          type
          language {
            name
          }
          object {
            __typename
            ... on Blob {
              text
            }
          }
        }
      }
    }
  }
}
    `),AddCommentDocument=new TypedDocumentString(`
    mutation AddComment($subjectId: ID!, $body: String!) {
  addComment(input: {subjectId: $subjectId, body: $body}) {
    commentEdge {
      node {
        id
      }
    }
  }
}
    `),CreateGitHubDeploymentDocument=new TypedDocumentString(`
    mutation CreateGitHubDeployment($repositoryId: ID!, $environmentName: String!, $refId: ID!, $payload: String!, $description: String) {
  createDeployment(
    input: {autoMerge: false, description: $description, environment: $environmentName, refId: $refId, repositoryId: $repositoryId, requiredContexts: [], payload: $payload}
  ) {
    deployment {
      ...DeploymentFragment
    }
  }
}
    fragment DeploymentFragment on Deployment {
  id
  environment
  state
}`),DeleteGitHubDeploymentDocument=new TypedDocumentString(`
    mutation DeleteGitHubDeployment($deploymentId: ID!) {
  deleteDeployment(input: {id: $deploymentId}) {
    clientMutationId
  }
}
    `),DeleteGitHubDeploymentAndCommentDocument=new TypedDocumentString(`
    mutation DeleteGitHubDeploymentAndComment($deploymentId: ID!, $commentId: ID!) {
  deleteDeployment(input: {id: $deploymentId}) {
    clientMutationId
  }
  deleteIssueComment(input: {id: $commentId}) {
    clientMutationId
  }
}
    `),CreateGitHubDeploymentStatusDocument=new TypedDocumentString(`
    mutation CreateGitHubDeploymentStatus($deploymentId: ID!, $environment: String, $environmentUrl: String!, $logUrl: String!, $state: DeploymentStatusState!) {
  createDeploymentStatus(
    input: {autoInactive: false, deploymentId: $deploymentId, environment: $environment, environmentUrl: $environmentUrl, logUrl: $logUrl, state: $state}
  ) {
    deploymentStatus {
      deployment {
        ...DeploymentFragment
      }
    }
  }
}
    fragment DeploymentFragment on Deployment {
  id
  environment
  state
}`),CreateEnvironmentDocument=new TypedDocumentString(`
    mutation CreateEnvironment($repositoryId: ID!, $name: String!) {
  createEnvironment(input: {repositoryId: $repositoryId, name: $name}) {
    environment {
      ...EnvironmentFragment
    }
  }
}
    fragment EnvironmentFragment on Environment {
  name
  id
}`),GetEnvironmentDocument=new TypedDocumentString(`
    query GetEnvironment($owner: String!, $repo: String!, $environment_name: String!, $qualifiedName: String!) {
  repository(owner: $owner, name: $repo) {
    environment(name: $environment_name) {
      ...EnvironmentFragment
    }
    ref(qualifiedName: $qualifiedName) {
      id
      name
      prefix
    }
  }
}
    fragment EnvironmentFragment on Environment {
  name
  id
}`);var documents={"\n      query Files($owner: String!, $repo: String!, $path: String!) {\n        repository(owner: $owner, name: $repo) {\n          object(expression: $path) {\n            __typename\n            ... on Tree {\n              entries {\n                name\n                type\n                language {\n                  name\n                }\n                object {\n                  __typename\n                  ... on Blob {\n                    text\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    ":FilesDocument,"\n  mutation AddComment($subjectId: ID!, $body: String!) {\n    addComment(input: {subjectId: $subjectId, body: $body}) {\n      commentEdge {\n        node {\n          id\n        }\n      }\n    }\n  }\n":AddCommentDocument,"\n  mutation CreateGitHubDeployment(\n    $repositoryId: ID!\n    $environmentName: String!\n    $refId: ID!\n    $payload: String!\n    $description: String\n  ) {\n    createDeployment(\n      input: {\n        autoMerge: false\n        description: $description\n        environment: $environmentName\n        refId: $refId\n        repositoryId: $repositoryId\n        requiredContexts: []\n        payload: $payload\n      }\n    ) {\n      deployment {\n        ...DeploymentFragment\n      }\n    }\n  }\n":CreateGitHubDeploymentDocument,"\n  mutation DeleteGitHubDeployment($deploymentId: ID!) {\n    deleteDeployment(input: {id: $deploymentId}) {\n      clientMutationId\n    }\n  }\n":DeleteGitHubDeploymentDocument,"\n  mutation DeleteGitHubDeploymentAndComment(\n    $deploymentId: ID!\n    $commentId: ID!\n  ) {\n    deleteDeployment(input: {id: $deploymentId}) {\n      clientMutationId\n    }\n    deleteIssueComment(input: {id: $commentId}) {\n      clientMutationId\n    }\n  }\n":DeleteGitHubDeploymentAndCommentDocument,"\n  fragment DeploymentFragment on Deployment {\n    id\n    environment\n    state\n  }\n":DeploymentFragmentFragmentDoc,"\n  mutation CreateGitHubDeploymentStatus(\n    $deploymentId: ID!\n    $environment: String\n    $environmentUrl: String!\n    $logUrl: String!\n    $state: DeploymentStatusState!\n  ) {\n    createDeploymentStatus(\n      input: {\n        autoInactive: false\n        deploymentId: $deploymentId\n        environment: $environment\n        environmentUrl: $environmentUrl\n        logUrl: $logUrl\n        state: $state\n      }\n    ) {\n      deploymentStatus {\n        deployment {\n          ...DeploymentFragment\n        }\n      }\n    }\n  }\n":CreateGitHubDeploymentStatusDocument,"\n  fragment EnvironmentFragment on Environment {\n    name\n    id\n  }\n":EnvironmentFragmentFragmentDoc,"\n  mutation CreateEnvironment($repositoryId: ID!, $name: String!) {\n    createEnvironment(input: {repositoryId: $repositoryId, name: $name}) {\n      environment {\n        ...EnvironmentFragment\n      }\n    }\n  }\n":CreateEnvironmentDocument,"\n  query GetEnvironment(\n    $owner: String!\n    $repo: String!\n    $environment_name: String!\n    $qualifiedName: String!\n  ) {\n    repository(owner: $owner, name: $repo) {\n      environment(name: $environment_name) {\n        ...EnvironmentFragment\n      }\n      ref(qualifiedName: $qualifiedName) {\n        id\n        name\n        prefix\n      }\n    }\n  }\n":GetEnvironmentDocument};function graphql(source){return documents[source]??{}}__name(graphql,"graphql");var request=__name(async params=>{let{query,variables,options}=params,{errorThrows}=options||{errorThrows:!0},{gitHubApiToken}=useCommonInputs(),{graphqlEndpoint}=useContext();return fetch(graphqlEndpoint,{method:"POST",headers:{authorization:`bearer ${gitHubApiToken}`,"Content-Type":"application/json",Accept:"application/vnd.github.flash-preview+json"},body:JSON.stringify({query:query.toString(),variables})}).then(res=>res.json()).then(res=>{if(res.errors&&errorThrows)throw new Error(JSON.stringify(res.errors));return res})},"request");function lowercaseKeys(object){return object?Object.keys(object).reduce((newObj,key)=>(newObj[key.toLowerCase()]=object[key],newObj),{}):{}}__name(lowercaseKeys,"lowercaseKeys");function isPlainObject(value){if(typeof value!="object"||value===null)return!1;let prototype=Object.getPrototypeOf(value);return(prototype===null||prototype===Object.prototype||Object.getPrototypeOf(prototype)===null)&&!(Symbol.toStringTag in value)&&!(Symbol.iterator in value)}__name(isPlainObject,"isPlainObject");function mergeDeep(defaults,options){let result=Object.assign({},defaults);return Object.keys(options).forEach(key=>{isPlainObject(options[key])?key in defaults?result[key]=mergeDeep(defaults[key],options[key]):Object.assign(result,{[key]:options[key]}):Object.assign(result,{[key]:options[key]})}),result}__name(mergeDeep,"mergeDeep");function removeUndefinedProperties(obj){for(let key in obj)obj[key]===void 0&&delete obj[key];return obj}__name(removeUndefinedProperties,"removeUndefinedProperties");function merge(defaults,route,options){if(typeof route=="string"){let[method,url]=route.split(" ");options=Object.assign(url?{method,url}:{url:method},options)}else options=Object.assign({},route);options.headers=lowercaseKeys(options.headers),removeUndefinedProperties(options),removeUndefinedProperties(options.headers);let mergedOptions=mergeDeep(defaults||{},options);return defaults&&defaults.mediaType.previews.length&&(mergedOptions.mediaType.previews=defaults.mediaType.previews.filter(preview=>!mergedOptions.mediaType.previews.includes(preview)).concat(mergedOptions.mediaType.previews)),mergedOptions.mediaType.previews=mergedOptions.mediaType.previews.map(preview=>preview.replace(/-preview/,"")),mergedOptions}__name(merge,"merge");function addQueryParameters(url,parameters){let separator=/\?/.test(url)?"&":"?",names=Object.keys(parameters);if(names.length===0)return url;let query=names.map(name=>name==="q"?"q="+parameters.q.split("+").map(encodeURIComponent).join("+"):`${name}=${encodeURIComponent(parameters[name])}`).join("&");return url+separator+query}__name(addQueryParameters,"addQueryParameters");var urlVariableRegex=/\{[^}]+\}/g;function removeNonChars(variableName){return variableName.replace(/^\W+|\W+$/g,"").split(/,/)}__name(removeNonChars,"removeNonChars");function extractUrlVariableNames(url){let matches=url.match(urlVariableRegex);return matches?matches.map(removeNonChars).reduce((a,b)=>a.concat(b),[]):[]}__name(extractUrlVariableNames,"extractUrlVariableNames");function omit(object,keysToOmit){return Object.keys(object).filter(option=>!keysToOmit.includes(option)).reduce((obj,key)=>(obj[key]=object[key],obj),{})}__name(omit,"omit");function encodeReserved(str){return str.split(/(%[0-9A-Fa-f]{2})/g).map(function(part){return/%[0-9A-Fa-f]/.test(part)||(part=encodeURI(part).replace(/%5B/g,"[").replace(/%5D/g,"]")),part}).join("")}__name(encodeReserved,"encodeReserved");function encodeUnreserved(str){return encodeURIComponent(str).replace(/[!'()*]/g,function(c){return"%"+c.charCodeAt(0).toString(16).toUpperCase()})}__name(encodeUnreserved,"encodeUnreserved");function encodeValue(operator,value,key){return value=operator==="+"||operator==="#"?encodeReserved(value):encodeUnreserved(value),key?encodeUnreserved(key)+"="+value:value}__name(encodeValue,"encodeValue");function isDefined(value){return value!=null}__name(isDefined,"isDefined");function isKeyOperator(operator){return operator===";"||operator==="&"||operator==="?"}__name(isKeyOperator,"isKeyOperator");function getValues(context,operator,key,modifier){var value=context[key],result=[];if(isDefined(value)&&value!=="")if(typeof value=="string"||typeof value=="number"||typeof value=="boolean")value=value.toString(),modifier&&modifier!=="*"&&(value=value.substring(0,parseInt(modifier,10))),result.push(encodeValue(operator,value,isKeyOperator(operator)?key:""));else if(modifier==="*")Array.isArray(value)?value.filter(isDefined).forEach(function(value2){result.push(encodeValue(operator,value2,isKeyOperator(operator)?key:""))}):Object.keys(value).forEach(function(k){isDefined(value[k])&&result.push(encodeValue(operator,value[k],k))});else{let tmp=[];Array.isArray(value)?value.filter(isDefined).forEach(function(value2){tmp.push(encodeValue(operator,value2))}):Object.keys(value).forEach(function(k){isDefined(value[k])&&(tmp.push(encodeUnreserved(k)),tmp.push(encodeValue(operator,value[k].toString())))}),isKeyOperator(operator)?result.push(encodeUnreserved(key)+"="+tmp.join(",")):tmp.length!==0&&result.push(tmp.join(","))}else operator===";"?isDefined(value)&&result.push(encodeUnreserved(key)):value===""&&(operator==="&"||operator==="?")?result.push(encodeUnreserved(key)+"="):value===""&&result.push("");return result}__name(getValues,"getValues");function parseUrl(template){return{expand:expand.bind(null,template)}}__name(parseUrl,"parseUrl");function expand(template,context){var operators=["+","#",".","/",";","?","&"];return template.replace(/\{([^\{\}]+)\}|([^\{\}]+)/g,function(_,expression,literal){if(expression){let operator="",values=[];if(operators.indexOf(expression.charAt(0))!==-1&&(operator=expression.charAt(0),expression=expression.substr(1)),expression.split(/,/g).forEach(function(variable){var tmp=/([^:\*]*)(?::(\d+)|(\*))?/.exec(variable);values.push(getValues(context,operator,tmp[1],tmp[2]||tmp[3]))}),operator&&operator!=="+"){var separator=",";return operator==="?"?separator="&":operator!=="#"&&(separator=operator),(values.length!==0?operator:"")+values.join(separator)}else return values.join(",")}else return encodeReserved(literal)})}__name(expand,"expand");function parse(options){let method=options.method.toUpperCase(),url=(options.url||"/").replace(/:([a-z]\w+)/g,"{$1}"),headers=Object.assign({},options.headers),body,parameters=omit(options,["method","baseUrl","url","headers","request","mediaType"]),urlVariableNames=extractUrlVariableNames(url);url=parseUrl(url).expand(parameters),/^http/.test(url)||(url=options.baseUrl+url);let omittedParameters=Object.keys(options).filter(option=>urlVariableNames.includes(option)).concat("baseUrl"),remainingParameters=omit(parameters,omittedParameters);if(!/application\/octet-stream/i.test(headers.accept)&&(options.mediaType.format&&(headers.accept=headers.accept.split(/,/).map(preview=>preview.replace(/application\/vnd(\.\w+)(\.v3)?(\.\w+)?(\+json)?$/,`application/vnd$1$2.${options.mediaType.format}`)).join(",")),options.mediaType.previews.length)){let previewsFromAcceptHeader=headers.accept.match(/[\w-]+(?=-preview)/g)||[];headers.accept=previewsFromAcceptHeader.concat(options.mediaType.previews).map(preview=>{let format=options.mediaType.format?`.${options.mediaType.format}`:"+json";return`application/vnd.github.${preview}-preview${format}`}).join(",")}return["GET","HEAD"].includes(method)?url=addQueryParameters(url,remainingParameters):"data"in remainingParameters?body=remainingParameters.data:Object.keys(remainingParameters).length&&(body=remainingParameters),!headers["content-type"]&&typeof body<"u"&&(headers["content-type"]="application/json; charset=utf-8"),["PATCH","PUT"].includes(method)&&typeof body>"u"&&(body=""),Object.assign({method,url,headers},typeof body<"u"?{body}:null,options.request?{request:options.request}:null)}__name(parse,"parse");function endpointWithDefaults(defaults,route,options){return parse(merge(defaults,route,options))}__name(endpointWithDefaults,"endpointWithDefaults");function withDefaults(oldDefaults,newDefaults){let DEFAULTS2=merge(oldDefaults,newDefaults),endpoint2=endpointWithDefaults.bind(null,DEFAULTS2);return Object.assign(endpoint2,{DEFAULTS:DEFAULTS2,defaults:withDefaults.bind(null,DEFAULTS2),merge:merge.bind(null,DEFAULTS2),parse})}__name(withDefaults,"withDefaults");function getUserAgent(){return typeof navigator=="object"&&"userAgent"in navigator?navigator.userAgent:typeof process=="object"&&process.version!==void 0?`Node.js/${process.version.substr(1)} (${process.platform}; ${process.arch})`:"<environment undetectable>"}__name(getUserAgent,"getUserAgent");var VERSION="2.8.0";var userAgent=`octokit-next-endpoint.js/${VERSION} ${getUserAgent()}`,DEFAULTS={method:"GET",baseUrl:"https://api.github.com",headers:{accept:"application/vnd.github.v3+json","user-agent":userAgent},mediaType:{format:"",previews:[]}};var endpoint=withDefaults(null,DEFAULTS);var VERSION2="2.8.0";function isObject(o){return Object.prototype.toString.call(o)==="[object Object]"}__name(isObject,"isObject");function isPlainObject2(o){var ctor,prot;return isObject(o)===!1?!1:(ctor=o.constructor,ctor===void 0?!0:(prot=ctor.prototype,!(isObject(prot)===!1||prot.hasOwnProperty("isPrototypeOf")===!1)))}__name(isPlainObject2,"isPlainObject");var RequestError=class extends Error{static{__name(this,"RequestError")}name;status;request;response;constructor(message,statusCode,options){super(message),Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor),this.name="HttpError",this.status=statusCode,"response"in options&&(this.response=options.response);let requestCopy={...options.request};options.request.headers.authorization&&(requestCopy.headers={...options.request.headers,authorization:options.request.headers.authorization.replace(/ .*$/," [REDACTED]")}),requestCopy.url=requestCopy.url.replace(/\bclient_secret=\w+/g,"client_secret=[REDACTED]").replace(/\baccess_token=\w+/g,"access_token=[REDACTED]"),this.request=requestCopy}};function getBufferResponse(response){return response.arrayBuffer()}__name(getBufferResponse,"getBufferResponse");function fetchWrapper(requestOptions){let log=requestOptions.request?.log||console;(isPlainObject2(requestOptions.body)||Array.isArray(requestOptions.body))&&(requestOptions.body=JSON.stringify(requestOptions.body));let responseHeaders={},status,url,{redirect,fetch:fetch2,...remainingRequestOptions}=requestOptions.request||{},fetchOptions={method:requestOptions.method,body:requestOptions.body,headers:requestOptions.headers,redirect,...remainingRequestOptions};return(fetch2||globalThis.fetch)(requestOptions.url,fetchOptions).then(async response=>{url=response.url,status=response.status;for(let keyAndValue of response.headers)responseHeaders[keyAndValue[0]]=keyAndValue[1];if("deprecation"in responseHeaders){let matches=responseHeaders.link&&responseHeaders.link.match(/<([^>]+)>; rel="deprecation"/),deprecationLink=matches&&matches.pop();log.warn(`[@octokit/request] "${requestOptions.method} ${requestOptions.url}" is deprecated. It is scheduled to be removed on ${responseHeaders.sunset}${deprecationLink?`. See ${deprecationLink}`:""}`)}if(!(status===204||status===205)){if(requestOptions.method==="HEAD"){if(status<400)return;throw new RequestError(response.statusText,status,{response:{url,status,headers:responseHeaders,data:void 0},request:requestOptions})}if(status===304)throw new RequestError("Not modified",status,{response:{url,status,headers:responseHeaders,data:await getResponseData(response)},request:requestOptions});if(status>=400){let data=await getResponseData(response);throw new RequestError(toErrorMessage(data),status,{response:{url,status,headers:responseHeaders,data},request:requestOptions})}return getResponseData(response)}}).then(data=>({status,url,headers:responseHeaders,data})).catch(error2=>{throw error2 instanceof RequestError||error2.name==="AbortError"?error2:new RequestError(error2.message,500,{request:requestOptions})})}__name(fetchWrapper,"fetchWrapper");async function getResponseData(response){let contentType=response.headers.get("content-type");return/application\/json/.test(contentType)?response.json():!contentType||/^text\/|charset=utf-8$/.test(contentType)?response.text():getBufferResponse(response)}__name(getResponseData,"getResponseData");function toErrorMessage(data){return typeof data=="string"?data:"message"in data?Array.isArray(data.errors)?`${data.message}: ${data.errors.map(JSON.stringify).join(", ")}`:data.message:`Unknown error: ${JSON.stringify(data)}`}__name(toErrorMessage,"toErrorMessage");function withDefaults2(oldEndpoint,newDefaults){let endpoint2=oldEndpoint.defaults(newDefaults);return Object.assign(__name(function(route,parameters){let endpointOptions=endpoint2.merge(route,parameters);if(!endpointOptions.request||!endpointOptions.request.hook)return fetchWrapper(endpoint2.parse(endpointOptions));let request3=__name((route2,parameters2)=>fetchWrapper(endpoint2.parse(endpoint2.merge(route2,parameters2))),"request");return Object.assign(request3,{endpoint:endpoint2,defaults:withDefaults2.bind(null,endpoint2)}),endpointOptions.request.hook(request3,endpointOptions)},"newApi"),{endpoint:endpoint2,defaults:withDefaults2.bind(null,endpoint2)})}__name(withDefaults2,"withDefaults");var request2=withDefaults2(endpoint,{headers:{"user-agent":`octokit-next-request.js/${VERSION2} ${getUserAgent()}`}});var REGEX_IS_INSTALLATION_LEGACY=/^v1\./,REGEX_IS_INSTALLATION=/^ghs_/,REGEX_IS_USER_TO_SERVER=/^ghu_/;async function auth(token){let isApp=token.split(/\./).length===3,isInstallation=REGEX_IS_INSTALLATION_LEGACY.test(token)||REGEX_IS_INSTALLATION.test(token),isUserToServer=REGEX_IS_USER_TO_SERVER.test(token);return{type:"token",token,tokenType:isApp?"app":isInstallation?"installation":isUserToServer?"user-to-server":"oauth"}}__name(auth,"auth");function withAuthorizationPrefix(token){return token.split(/\./).length===3?`bearer ${token}`:`token ${token}`}__name(withAuthorizationPrefix,"withAuthorizationPrefix");async function hook(token,request3,route,parameters){let endpoint2=request3.endpoint.merge(route,parameters);return endpoint2.headers.authorization=withAuthorizationPrefix(token),request3(endpoint2)}__name(hook,"hook");function createTokenAuth(options){if(!options?.token)throw new Error("[@octokit/auth-token] options.token not set for createTokenAuth(options)");if(typeof options?.token!="string")throw new Error("[@octokit/auth-token] options.token is not a string for createTokenAuth(options)");let token=options.token.replace(/^(token|bearer) +/i,"");return Object.assign(auth.bind(null,token),{hook:hook.bind(null,token)})}__name(createTokenAuth,"createTokenAuth");var VERSION3="2.8.0";function _buildMessageForResponseErrors(data){return`Request failed due to following response errors:
`+data.errors.map(e=>` - ${e.message}`).join(`
`)}__name(_buildMessageForResponseErrors,"_buildMessageForResponseErrors");var GraphqlResponseError=class extends Error{static{__name(this,"GraphqlResponseError")}constructor(request3,headers,response){super(_buildMessageForResponseErrors(response)),this.request=request3,this.headers=headers,this.response=response,this.name="GraphqlResponseError",this.errors=response.errors,this.data=response.data,Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}};var NON_VARIABLE_OPTIONS=["method","baseUrl","url","headers","request","query","mediaType"],FORBIDDEN_VARIABLE_OPTIONS=["query","method","url"],GHES_V3_SUFFIX_REGEX=/\/api\/v3\/?$/;function graphql2(request3,query,options){if(options){if(typeof query=="string"&&"query"in options)return Promise.reject(new Error('[@octokit/graphql] "query" cannot be used as variable name'));for(let key in options)if(FORBIDDEN_VARIABLE_OPTIONS.includes(key))return Promise.reject(new Error(`[@octokit/graphql] "${key}" cannot be used as variable name`))}let parsedOptions=typeof query=="string"?Object.assign({query},options):query,requestOptions=Object.keys(parsedOptions).reduce((result,key)=>NON_VARIABLE_OPTIONS.includes(key)?(result[key]=parsedOptions[key],result):(result.variables||(result.variables={}),result.variables[key]=parsedOptions[key],result),{}),baseUrl=parsedOptions.baseUrl||request3.endpoint.DEFAULTS.baseUrl;return GHES_V3_SUFFIX_REGEX.test(baseUrl)&&(requestOptions.url=baseUrl.replace(GHES_V3_SUFFIX_REGEX,"/api/graphql")),request3(requestOptions).then(response=>{if(response.data.errors){let headers={};for(let key of Object.keys(response.headers))headers[key]=response.headers[key];throw new GraphqlResponseError(requestOptions,headers,response.data)}return response.data.data})}__name(graphql2,"graphql");function withDefaults3(oldRequest,newDefaults){let newRequest=oldRequest.defaults(newDefaults);return Object.assign(__name((query,options)=>graphql2(newRequest,query,options),"newApi"),{defaults:withDefaults3.bind(null,newRequest),endpoint:newRequest.endpoint})}__name(withDefaults3,"withDefaults");var graphql3=withDefaults3(request2,{headers:{"user-agent":`octokit-next-graphql.js/${VERSION3} ${getUserAgent()}`},method:"POST",url:"/graphql"});function withCustomRequest(customRequest){return withDefaults3(customRequest,{method:"POST",url:"/graphql"})}__name(withCustomRequest,"withCustomRequest");function register(state,name,method,options){if(typeof method!="function")throw new Error("method for before hook must be a function");return options||(options={}),Array.isArray(name)?name.reverse().reduce((callback,name2)=>register.bind(null,state,name2,callback,options),method)():Promise.resolve().then(()=>state.registry[name]?state.registry[name].reduce((method2,registered)=>registered.hook.bind(null,method2,options),method)():method(options))}__name(register,"register");function addHook(state,kind,name,hook2){let orig=hook2;state.registry[name]||(state.registry[name]=[]),kind==="before"&&(hook2=__name((method,options)=>Promise.resolve().then(orig.bind(null,options)).then(method.bind(null,options)),"hook")),kind==="after"&&(hook2=__name((method,options)=>{let result;return Promise.resolve().then(method.bind(null,options)).then(result_=>(result=result_,orig(result,options))).then(()=>result)},"hook")),kind==="error"&&(hook2=__name((method,options)=>Promise.resolve().then(method.bind(null,options)).catch(error2=>orig(error2,options)),"hook")),state.registry[name].push({hook:hook2,orig})}__name(addHook,"addHook");function removeHook(state,name,method){if(!state.registry[name])return;let index=state.registry[name].map(registered=>registered.orig).indexOf(method);index!==-1&&state.registry[name].splice(index,1)}__name(removeHook,"removeHook");var bind=Function.bind,bindable=bind.bind(bind);function bindApi(hook2,state,name){let removeHookRef=bindable(removeHook,null).apply(null,name?[state,name]:[state]);hook2.api={remove:removeHookRef},hook2.remove=removeHookRef,["before","error","after","wrap"].forEach(kind=>{let args=name?[state,kind,name]:[state,kind];hook2[kind]=hook2.api[kind]=bindable(addHook,null).apply(null,args)})}__name(bindApi,"bindApi");function Singular(){let singularHookName=Symbol("Singular"),singularHookState={registry:{}},singularHook=register.bind(null,singularHookState,singularHookName);return bindApi(singularHook,singularHookState,singularHookName),singularHook}__name(Singular,"Singular");function Collection(){let state={registry:{}},hook2=register.bind(null,state);return bindApi(hook2,state),hook2}__name(Collection,"Collection");var before_after_hook_default={Singular,Collection};var VERSION4="2.8.0";var Octokit=class{static{__name(this,"Octokit")}static VERSION=VERSION4;static DEFAULTS={baseUrl:endpoint.DEFAULTS.baseUrl,userAgent:`octokit-next-core.js/${VERSION4} ${getUserAgent()}`};static withPlugins(newPlugins){let currentPlugins=this.PLUGINS;return class extends this{static PLUGINS=currentPlugins.concat(newPlugins.filter(plugin=>!currentPlugins.includes(plugin)))}}static withDefaults(defaults){let newDefaultUserAgent=[defaults?.userAgent,this.DEFAULTS.userAgent].filter(Boolean).join(" "),newDefaults={...this.DEFAULTS,...defaults,userAgent:newDefaultUserAgent,request:{...this.DEFAULTS.request,...defaults?.request}};return class extends this{constructor(options){if(typeof defaults=="function"){super(defaults(options,newDefaults));return}super(options)}static DEFAULTS=newDefaults}}static PLUGINS=[];constructor(options={}){this.options={...this.constructor.DEFAULTS,...options,request:{...this.constructor.DEFAULTS.request,...options?.request}};let hook2=new before_after_hook_default.Collection,requestDefaults={baseUrl:this.options.baseUrl,headers:{},request:{...this.options.request,hook:hook2.bind(null,"request")},mediaType:{previews:[],format:""}},userAgent2=[options?.userAgent,this.constructor.DEFAULTS.userAgent].filter(Boolean).join(" ");if(requestDefaults.headers["user-agent"]=userAgent2,this.options.previews&&(requestDefaults.mediaType.previews=this.options.previews),this.options.timeZone&&(requestDefaults.headers["time-zone"]=this.options.timeZone),this.constructor.PLUGINS.forEach(plugin=>{Object.assign(this,plugin(this,this.options))}),this.request=request2.defaults(requestDefaults),this.graphql=withCustomRequest(this.request).defaults(requestDefaults),this.log=Object.assign({debug:__name(()=>{},"debug"),info:__name(()=>{},"info"),warn:console.warn.bind(console),error:console.error.bind(console)},this.options.log),this.hook=hook2,this.options.authStrategy){let{authStrategy,...otherOptions}=this.options,auth2=authStrategy(Object.assign({request:this.request,log:this.log,octokit:this,octokitOptions:otherOptions},this.options.auth));hook2.wrap("request",auth2.hook),this.auth=auth2}else if(!this.options.auth)this.auth=async()=>({type:"unauthenticated"});else{let auth2=createTokenAuth({token:this.options.auth});hook2.wrap("request",auth2.hook),this.auth=auth2}}};var VERSION5="0.0.0-development";function normalizePaginatedListResponse(response){if(!response.data)return{...response,data:[]};if(!("total_count"in response.data&&!("url"in response.data)))return response;let incompleteResults=response.data.incomplete_results,repositorySelection=response.data.repository_selection,totalCount=response.data.total_count;delete response.data.incomplete_results,delete response.data.repository_selection,delete response.data.total_count;let namespaceKey=Object.keys(response.data)[0],data=response.data[namespaceKey];return response.data=data,typeof incompleteResults<"u"&&(response.data.incomplete_results=incompleteResults),typeof repositorySelection<"u"&&(response.data.repository_selection=repositorySelection),response.data.total_count=totalCount,response}__name(normalizePaginatedListResponse,"normalizePaginatedListResponse");function iterator(octokit,route,parameters){let options=typeof route=="function"?route.endpoint(parameters):octokit.request.endpoint(route,parameters),requestMethod=typeof route=="function"?route:octokit.request,method=options.method,headers=options.headers,url=options.url;return{[Symbol.asyncIterator]:()=>({async next(){if(!url)return{done:!0};try{let response=await requestMethod({method,url,headers}),normalizedResponse=normalizePaginatedListResponse(response);return url=((normalizedResponse.headers.link||"").match(/<([^>]+)>;\s*rel="next"/)||[])[1],{value:normalizedResponse}}catch(error2){if(error2.status!==409)throw error2;return url="",{value:{status:200,headers:{},data:[]}}}}})}}__name(iterator,"iterator");function paginate(octokit,route,parameters,mapFn){return typeof parameters=="function"&&(mapFn=parameters,parameters=void 0),gather(octokit,[],iterator(octokit,route,parameters)[Symbol.asyncIterator](),mapFn)}__name(paginate,"paginate");function gather(octokit,results,iterator2,mapFn){return iterator2.next().then(result=>{if(result.done)return results;let earlyExit=!1;function done(){earlyExit=!0}return __name(done,"done"),results=results.concat(mapFn?mapFn(result.value,done):result.value.data),earlyExit?results:gather(octokit,results,iterator2,mapFn)})}__name(gather,"gather");var composePaginateRest=Object.assign(paginate,{iterator});function paginateRest(octokit){return{paginate:Object.assign(paginate.bind(null,octokit),{iterator:iterator.bind(null,octokit)})}}__name(paginateRest,"paginateRest");paginateRest.VERSION=VERSION5;var paginate2=__name(async(endpoint2,options)=>{let{gitHubApiToken}=useCommonInputs();return new(Octokit.withPlugins([paginateRest]))({auth:gitHubApiToken}).paginate(endpoint2,options)},"paginate");var MutationAddComment=graphql(`
  mutation AddComment($subjectId: ID!, $body: String!) {
    addComment(input: {subjectId: $subjectId, body: $body}) {
      commentEdge {
        node {
          id
        }
      }
    }
  }
`),getNodeIdFromEvent=__name(async()=>{let{eventName,payload}=useContextEvent();if(eventName==="workflow_dispatch"){let{repo,branch}=useContext();return(await paginate2("GET /repos/{owner}/{repo}/pulls",{owner:repo.owner,repo:repo.repo,per_page:100})).find(item=>item.head.ref===branch)?.node_id}if(eventName==="pull_request"&&payload.action!=="closed")return payload.pull_request.node_id??raise("No pull request node id")},"getNodeIdFromEvent"),addComment=__name(async(deployment,output)=>{let{eventName}=useContextEvent(),prNodeId=await getNodeIdFromEvent();if(prNodeId){let{sha}=useContext(),rawBody=`## Cloudflare Pages Deployment
**Event Name:** ${eventName}
**Environment:** ${deployment.environment}
**Project:** ${deployment.project_name}
**Built with commit:** ${sha}
**Preview URL:** ${deployment.url}
**Branch Preview URL:** ${getCloudflareDeploymentAlias(deployment)}

### Wrangler Output
${output}`;return(await request({query:MutationAddComment,variables:{subjectId:prNodeId,body:rawBody}})).data.addComment?.commentEdge?.node?.id}(0,import_core9.info)("addComment - No Pull Request could be found to post comment.")},"addComment");var import_core10=__toESM(require_core(),1);var PREFIX="GitHub Environment:",EnvironmentFragment=graphql(`
  fragment EnvironmentFragment on Environment {
    name
    id
  }
`),MutationCreateEnvironment=graphql(`
  mutation CreateEnvironment($repositoryId: ID!, $name: String!) {
    createEnvironment(input: {repositoryId: $repositoryId, name: $name}) {
      environment {
        ...EnvironmentFragment
      }
    }
  }
`);var QueryGetEnvironment=graphql(`
  query GetEnvironment(
    $owner: String!
    $repo: String!
    $environment_name: String!
    $qualifiedName: String!
  ) {
    repository(owner: $owner, name: $repo) {
      environment(name: $environment_name) {
        ...EnvironmentFragment
      }
      ref(qualifiedName: $qualifiedName) {
        id
        name
        prefix
      }
    }
  }
`),checkEnvironment=__name(async()=>{let{gitHubEnvironment}=useCommonInputs(),{repo,ref}=useContext();if(!gitHubEnvironment)return raiseFail(`${PREFIX} missing input gitHubEnvironment ${gitHubEnvironment}`);let environment=await request({query:QueryGetEnvironment,variables:{owner:repo.owner,repo:repo.repo,environment_name:gitHubEnvironment,qualifiedName:ref},options:{errorThrows:!1}});return environment.errors?raiseFail(`${PREFIX} Errors - ${JSON.stringify(environment.errors)}`):environment.data.repository?.environment?environment.data.repository?.ref?.id?{...environment.data.repository.environment,refId:environment.data.repository?.ref?.id}:raiseFail(`${PREFIX} No ref id ${gitHubEnvironment}`):raiseFail(`${PREFIX} Not created for ${gitHubEnvironment}`)},"checkEnvironment");var MutationCreateGitHubDeploymentStatus=graphql(`
  mutation CreateGitHubDeploymentStatus(
    $deploymentId: ID!
    $environment: String
    $environmentUrl: String!
    $logUrl: String!
    $state: DeploymentStatusState!
  ) {
    createDeploymentStatus(
      input: {
        autoInactive: false
        deploymentId: $deploymentId
        environment: $environment
        environmentUrl: $environmentUrl
        logUrl: $logUrl
        state: $state
      }
    ) {
      deploymentStatus {
        deployment {
          ...DeploymentFragment
        }
      }
    }
  }
`);var MutationCreateGitHubDeployment=graphql(`
  mutation CreateGitHubDeployment(
    $repositoryId: ID!
    $environmentName: String!
    $refId: ID!
    $payload: String!
    $description: String
  ) {
    createDeployment(
      input: {
        autoMerge: false
        description: $description
        environment: $environmentName
        refId: $refId
        repositoryId: $repositoryId
        requiredContexts: []
        payload: $payload
      }
    ) {
      deployment {
        ...DeploymentFragment
      }
    }
  }
`),createGitHubDeployment=__name(async({cloudflareDeployment:{id,url,project_name:projectName},cloudflareAccountId:accountId,commentId})=>{let{name,refId}=await checkEnvironment()??raise("GitHub Deployment: GitHub Environment is required"),{repo}=useContext(),payload={cloudflare:{id,projectName,accountId},url,commentId},gitHubDeploymentId=(await request({query:MutationCreateGitHubDeployment,variables:{repositoryId:repo.node_id,environmentName:name,refId,payload:JSON.stringify(payload),description:`Cloudflare Pages Deployment: ${id}`}})).data.createDeployment?.deployment?.id??raise("GitHub Deployment: GitHub deployment id is required");await request({query:MutationCreateGitHubDeploymentStatus,variables:{environment:name,deploymentId:gitHubDeploymentId,environmentUrl:url,logUrl:getCloudflareLogEndpoint({id,accountId,projectName}),state:"SUCCESS"}})},"createGitHubDeployment");var import_core11=__toESM(require_core(),1);var OPTIONS={required:!0},getInputs2=__name(()=>({cloudflareAccountId:(0,import_core11.getInput)(INPUT_KEY_CLOUDFLARE_ACCOUNT_ID,OPTIONS),cloudflareProjectName:(0,import_core11.getInput)(INPUT_KEY_CLOUDFLARE_PROJECT_NAME,OPTIONS),directory:(0,import_core11.getInput)(INPUT_KEY_DIRECTORY,OPTIONS),workingDirectory:checkWorkingDirectory((0,import_core11.getInput)(INPUT_KEY_WORKING_DIRECTORY,{required:!1}))}),"getInputs"),_inputs2,useInputs=__name(()=>_inputs2??(_inputs2=getInputs2()),"useInputs");async function run(){let{cloudflareAccountId,cloudflareProjectName,directory,workingDirectory}=useInputs(),{eventName}=useContextEvent();if(eventName!=="push"&&eventName!=="pull_request"&&eventName!=="workflow_dispatch"){(0,import_core12.setFailed)(`GitHub Action event name '${eventName}' not supported.`);return}let{deployment:cloudflareDeployment,wranglerOutput}=await createCloudflareDeployment({accountId:cloudflareAccountId,projectName:cloudflareProjectName,directory,workingDirectory}),commentId=await addComment(cloudflareDeployment,wranglerOutput);await createGitHubDeployment({cloudflareDeployment,commentId,cloudflareAccountId})}__name(run,"run");try{run()}catch(error2){error2 instanceof Error&&(0,import_core13.setFailed)(error2.message)}
//# sourceMappingURL=index.js.map
